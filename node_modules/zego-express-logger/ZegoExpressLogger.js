((t,n)=>{if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("protobufjs/minimal"),require("long"));else if("function"==typeof define&&define.amd)define(["protobufjs/minimal","long"],n);else{var i,r="object"==typeof exports?n(require("protobufjs/minimal"),require("long")):n(t["protobufjs/minimal"],t.long);for(i in r)("object"==typeof exports?exports:t)[i]=r[i]}})("undefined"!=typeof self?self:this,function(i,r){return s=[,function(t,n){t.exports=i},function(t,n){t.exports=r},function(U,t,n){n.r(t),n.d(t,"ZegoLogger",function(){return He}),n.d(t,"ZegoDataReport",function(){return C}),n.d(t,"createZegoWebSocket",function(){return M}),n.d(t,"LoggerStateCenter",function(){return D});i.getInstance=function(){return i.instance||(i.instance=new i).u(),i.instance},i.prototype.u=function(){},Object.defineProperty(i.prototype,"testEnvironment",{get:function(){return this.h},set:function(t){this.h=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ENV",{get:function(){return this.v},set:function(t){this.v=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"debug",{get:function(){return this._},set:function(t){this._=t},enumerable:!1,configurable:!0}),i.instance=new i;var o,N,e,D=i;function i(){this.h=!1,this.v=0,this._=!1}(t=f=f||{})[t.IE=0]="IE",t[t.FIREFOX=1]="FIREFOX",t[t.CHROME=2]="CHROME",t[t.SAFARI=3]="SAFARI",t[t.OPERA=4]="OPERA",t[t.WEIXIN=5]="WEIXIN",t[t.WEIXINMINI=6]="WEIXINMINI",t[t.UNKOWN=7]="UNKOWN",(f=o=o||{})[f.BROWSER=0]="BROWSER",f[f.WEIXINMINI=1]="WEIXINMINI",N=N||{},N[N.DEFAULT=0]="DEFAULT",(t=e=e||{})[t.DISABLE=0]="DISABLE",t[t.WEBSOCKET=1]="WEBSOCKET",t[t.HTTPS=2]="HTTPS";var I,L,s={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},P=(0,0,0,(f=I=I||{})[f.IPv4Only=0]="IPv4Only",f[f.IPv4Prefer=1]="IPv4Prefer",f[f.IPv6Prefer=2]="IPv6Prefer",(t=L=L||{})[t.offline=0]="offline",t[t.online=1]="online",F.prototype.init=function(){var n=this;this.g&&(this.readyState=0,this.g.onOpen(function(t){n.readyState=n.g.readyState,"function"==typeof n.onopen&&(n.onopen(t),n.g.onClose(function(t){n.readyState=n.g.readyState,"function"==typeof n.onclose&&n.onclose(t)}),n.g.onMessage(function(t){"function"==typeof n.onmessage&&n.onmessage(t)}))}),this.g.onError(function(t){n.readyState=n.g.readyState,"function"==typeof n.onerror&&n.onerror(t)}))},F.prototype.onopen=function(t){},F.prototype.onerror=function(t){},F.prototype.onclose=function(t){},F.prototype.onmessage=function(t){},F.prototype.send=function(t){this.g&&this.g.send({data:t})},F.prototype.close=function(){this.g&&this.g.close()},F);function F(t,n){this.url=t,this.readyState=3,this.init()}function M(t,n,i){return n%2===o.BROWSER?(n=t,(i=i)?i.createSocket(n,1):new WebSocket(n)):new P(t)}var z=function(){return(z=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},C=(r.prototype.newReport=function(t,n){this.dataStatistics[t]={event_time:Date.now(),time_consumed:0,seq:t,error:0,message:"success",event:n,events:[]}},r.prototype.addMsgExt=function(t,n){this.dataStatistics[t]?this.dataStatistics[t].msg_ext=n:console.warn("".concat(t," not exist"))},r.prototype.addMsgInfo=function(t,n){this.dataStatistics[t]?Object.assign(this.dataStatistics[t],n):console.warn("".concat(t," not exist"))},r.prototype.eventStart=function(t,n){this.dataStatistics[t]?null==this.dataStatistics[t].events?this.logger.warn("zd.es.0 no events"):this.dataStatistics[t].events.push({event:n,event_time:Date.now(),time_consumed:0}):this.logger.warn("zd.es.0 no seq match")},r.prototype.eventEnd=function(t,n,i){if(this.dataStatistics[t]){var r=this.dataStatistics[t].events;if(r&&0!==r.length){for(var e=r.length-1;0<=e;e--)if(r[e].event==n&&0==r[e].time_consumed){r[e].time_consumed=Date.now()-r[e].event_time;break}}else this.logger.info("zd.ee.0 no events")}else this.logger.info("zd.ee.0 no seq match")},r.prototype.eventEndWithMsg=function(t,n,i){if(this.dataStatistics[t]){var r=this.dataStatistics[t].events;if(r){for(var e=r.length-1;0<=e;e--)if(r[e].event==n&&0==r[e].time_consumed){r[e].time_consumed=Date.now()-r[e].event_time,null==r[e].msg_ext&&(r[e].msg_ext={}),r[e].msg_ext=z({},i);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},r.prototype.eventEndWithMsgInfo=function(t,n,i){if(this.dataStatistics[t]){var r=this.dataStatistics[t].events;if(r){for(var e=r.length-1;0<=e;e--)if(r[e].event==n&&0==r[e].time_consumed){r[e].time_consumed=Date.now()-r[e].event_time,Object.assign(r[e],i);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},r.prototype.addEventInfo=function(t,n,i,r){if(this.dataStatistics[t]){var e=this.dataStatistics[t].events;if(null==e)this.logger.warn("zd.aei.0 no events");else for(var s=e.length-1;0<=s;s--)if(e[s].event==n&&null!=e[s].time_consumed){null==e[s].msg_ext?e[s].msg_ext={}:e[s].msg_ext&&(e[s].msg_ext[i]=r);break}}else this.logger.warn("zd.aei.0 no seq match")},r.prototype.addEventMsg=function(t,n,i,r){if(this.dataStatistics[t]){var e=this.dataStatistics[t].events;if(null==e)this.logger.warn("zd.aem.0 no events");else for(var s=e.length-1;0<=s;s--)if(e[s].event==n){e[s][i]=r;break}}else this.logger.warn("zd.aem.0 no seq match")},r.prototype.addEvent=function(t,n,i){this.dataStatistics[t]?this.dataStatistics[t].events&&(i?this.dataStatistics[t].events.push({event:n,event_time:Date.now(),msg_ext:i}):this.dataStatistics[t].events.push({event:n,event_time:Date.now()})):this.logger.warn("zd.ae.0 no seq match")},r.prototype.uploadReport=function(t,n,i,r){var e=this.dataStatistics[t];null!=e&&(n&&(e.event=n),e.time_consumed=Date.now()-e.event_time,i&&this.addMsgInfo(t,{error:i.code,message:i.message||i.msg+" "+(r||"")}),this.logger.report(e),delete this.dataStatistics[t])},r);function r(t){this.dataStatistics={},this.logger=t}var H,B=["00","01","02","03","04","05","06","07","08","09"];function q(){var t=new Date;return[t.getFullYear()+"/",(B[t.getMonth()+1]||t.getMonth()+1)+"/",(B[t.getDate()]||t.getDate())+" ",(B[t.getHours()]||t.getHours())+":",(B[t.getMinutes()]||t.getMinutes())+":",B[t.getSeconds()]||t.getSeconds(),"."+t.getTime()%1e3].join("")}(f=H=H||{}).WEBSOCKET_STATE_CHANGE="zl.net.wsc",f.OPEN_WS="zl.net.opws";var a=n(1),t=n(2);(a=a.default||a).util.Long=t.default||t,a.util.Long.fromBits=a.util.Long.fromBits||function(){return 0};for(var l=a.roots,J=a.types?a.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},G=a.types?a.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},Y=Object.keys(J),V={$:function(t){return V[t]?V[t].call(this):l[t].decode?l[t].decode(this,this.uint32()):V.$.call(this,"int32")}},Q={$:function(t,n,i){var r=J[t];return void 0===r?l[t].encode?(this.uint32((i<<3|2)>>0).fork(),l[t].encode(n,this).ldelim()):Q.$.call(this,"int32",n,i):Q[t].call(this.uint32(i<<3|r),n)}},tt=0;tt<Y.length;tt++)V[Y[tt]]=a.Reader.prototype[Y[tt]],Q[Y[tt]]=a.Writer.prototype[Y[tt]];!function s(t,o,n,i){for(var r=0,e=Object.keys(t);r<e.length;r++){var u=e[r];if(t[u].$m&&Object.keys(t[u].$m).every(function(t){return Number(t)})){if(n[u])throw Error(`nested type ${n}.${u} has already exist`);n[u]=((c,t)=>{function h(t){for(var n in c){n=c[n];"{"===n[1].charAt(0)?this[n[0]]={}:"["!==n[1].charAt(0)&&"<"!==n[1].charAt(0)||(this[n[0]]=[])}if(t)for(var i=Object.keys(t),r=0;r<i.length;++r)null!=t[i[r]]&&(this[i[r]]=t[i[r]])}var n,i={};for(n in c){var r=c[n],e=r[1];"{"===e.charAt(0)?(h.prototype[r[0]]=a.util.emptyObject,i[e]={$m:e.substring(1).split(",").map(function(t,n){return["$"+(n+1),t,null]}).reduce(function(t,n,i){return t[i+1]=n,t},{})}):"["===e.charAt(0)||"<"===e.charAt(0)?h.prototype[r[0]]=a.util.emptyArray:"bytes"===e?h.prototype[r[0]]=a.util.newBuffer([]):r[2]&&r[2].hasOwnProperty("low")&&r[2].hasOwnProperty("high")?h.prototype[r[0]]=a.util.Long.fromBits(r[2].low,r[2].high,r[2].unsigned):h.prototype[r[0]]=r[2]}return h.create=function(t){return new h(t)},h.decode=function(t,n){t instanceof a.Reader||(t=a.Reader.create(t));for(var i=void 0===n?t.len:t.pos+n,r=new h;t.pos<i;){var e=t.uint32(),s=e>>>3;if(0<s&&c[s]){var o=c[s][0];if("{"===(u=c[s][1]).charAt(0)){r[o]===a.util.emptyObject&&(r[o]={});s=h.$namespace[u].decode(t,t.uint32());r[o][s.$1]=s.$2}else if("["===u.charAt(0)||"<"===u.charAt(0)){u=u.substring(1),r[o]&&r[o].length||(r[o]=[]);var u,s=!V[u]&&!l[u].decode;if(void 0!==G[u=s?"int32":u]&&2==(7&e))for(var f=t.uint32()+t.pos;t.pos<f;)r[o].push(V.$.call(t,u));else r[o].push(V.$.call(t,u))}else r[o]=V.$.call(t,u)}else t.skipType(7&e)}return r},h.encode=function(t,n){for(var i in n=n||a.Writer.create(),c){var r=c[i][0];if("{"===(f=c[i][1]).charAt(0)){if(null!=t[r]&&t.hasOwnProperty(r))for(var e=0,s=Object.keys(t[r]);e<s.length;++e)n.uint32((i<<3|2)>>0).fork(),h.$namespace[f].encode({$1:s[e],$2:t[r][s[e]]},n).ldelim()}else if("["===f.charAt(0)||"<"===f.charAt(0)){var o="<"===f.charAt(0),u=(f=f.substring(1),t[r]);if(null!=u&&u.length){var f=void 0===J[f]&&!l[f].encode?"int32":f;if(o&&void 0!==G[f]){n.uint32((i<<3|2)>>0).fork();for(e=0;e<u.length;e++)Q[f].call(n,u[e]);n.ldelim()}else for(e=0;e<u.length;e++)Q.$.call(n,f,u[e],i)}}else null!=t[r]&&t.hasOwnProperty(r)&&Q.$.call(n,f,t[r],i)}return n},Object.keys(i).length&&(h.$namespace=s(i,o+"."+t,h.$namespace||{},!0)),h})(t[u].$m,u)}else t[u].$s?n[u]=((n,e)=>{function s(t,n,i){a.rpc.Service.call(this,t,n,i)}return((s.prototype=Object.create(a.rpc.Service.prototype)).constructor=s).create=function(t,n,i){return new s(t,n,i)},Object.keys(n).forEach(function(t){var i=n[t];function r(t,n){return this.rpcCall(r,l[i[0]],l[i[1]],t,n)}Object.defineProperty(r,"name",{value:t}),Object.defineProperty(r,"path",{value:o+"."+e}),s.prototype[t]=r}),s})(t[u].$s,u):t[u].$e&&Object.values(t[u].$e).every(function(t){return Number(t)===t})&&(n[u]=(t=>{for(var n=Object.keys(t),i={},r=0;r<n.length;r++)i[i[n[r]]=t[n[r]]]=n[r];return i})(t[u].$e));n[u]&&!i&&(l[o+"."+u]=n[u]),delete t[u].$m,delete t[u].$s,delete t[u].$e,n[u]=s(t[u],Boolean(o)?o+"."+u:u,n[u]||{})}return n}({report:{rtcreport:{DetailLogRequest:{$m:{1:["appid","uint32",0],2:["product","uint32",0],3:["id_name","string",""],4:["timestamp","uint64",{low:0,high:0,unsigned:!0}],5:["litesign","string",""],6:["detail_data","bytes",[]]}},DetailLogResponse:{$m:{1:["code","uint32",0]}}}}},"",l,!1);var nt=l.report;let it=0,rt=1;function et(t){let n=t.length;for(;0<=--n;)t[n]=0}let st=29,ot=256,ut=ot+1+st,ft=30,ct=19,ht=2*ut+1,at=15,lt=16,vt=7,dt=256,wt=16,bt=17,yt=18,_t=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),mt=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),pt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),gt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);let u=new Array(2*(ut+2)),Ot=(et(u),new Array(2*ft)),kt=(et(Ot),new Array(512)),Et=(et(kt),new Array(256)),At=(et(Et),new Array(st)),St=(et(At),new Array(ft));function jt(t,n,i,r,e){this.static_tree=t,this.extra_bits=n,this.extra_base=i,this.elems=r,this.max_length=e,this.has_stree=t&&t.length}et(St);let Rt,xt,Tt;function Zt(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}let Ut=t=>t<256?kt[t]:kt[256+(t>>>7)],Nt=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},h=(t,n,i)=>{t.bi_valid>lt-i?(t.bi_buf|=n<<t.bi_valid&65535,Nt(t,t.bi_buf),t.bi_buf=n>>lt-t.bi_valid,t.bi_valid+=i-lt):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=i)},v=(t,n,i)=>{h(t,i[2*n],i[2*n+1])},Dt=(t,n)=>{let i=0;for(;i|=1&t,t>>>=1,i<<=1,0<--n;);return i>>>1},It=(t,n)=>{var i,r=n.dyn_tree,e=n.max_code,s=n.stat_desc.static_tree,o=n.stat_desc.has_stree,u=n.stat_desc.extra_bits,f=n.stat_desc.extra_base,c=n.stat_desc.max_length;let h,a,l,v,d,w=0;for(v=0;v<=at;v++)t.bl_count[v]=0;for(r[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<ht;h++)a=t.heap[h],(v=r[2*r[2*a+1]+1]+1)>c&&(v=c,w++),r[2*a+1]=v,a>e||(t.bl_count[v]++,d=0,a>=f&&(d=u[a-f]),i=r[2*a],t.opt_len+=i*(v+d),o&&(t.static_len+=i*(s[2*a+1]+d)));if(0!==w){do{for(v=c-1;0===t.bl_count[v];)v--}while(t.bl_count[v]--,t.bl_count[v+1]+=2,t.bl_count[c]--,0<(w-=2));for(v=c;0!==v;v--)for(a=t.bl_count[v];0!==a;)e<(l=t.heap[--h])||(r[2*l+1]!==v&&(t.opt_len+=(v-r[2*l+1])*r[2*l],r[2*l+1]=v),a--)}},Lt=(t,n,i)=>{var r=new Array(at+1);let e=0,s,o;for(s=1;s<=at;s++)e=e+i[s-1]<<1,r[s]=e;for(o=0;o<=n;o++){var u=t[2*o+1];0!==u&&(t[2*o]=Dt(r[u]++,u))}},Pt=t=>{let n;for(n=0;n<ut;n++)t.dyn_ltree[2*n]=0;for(n=0;n<ft;n++)t.dyn_dtree[2*n]=0;for(n=0;n<ct;n++)t.bl_tree[2*n]=0;t.dyn_ltree[2*dt]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Ft=t=>{8<t.bi_valid?Nt(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Mt=(t,n,i,r)=>{var e=2*n,s=2*i;return t[e]<t[s]||t[e]===t[s]&&r[n]<=r[i]},zt=(t,n,i)=>{var r=t.heap[i];let e=i<<1;for(;e<=t.heap_len&&(e<t.heap_len&&Mt(n,t.heap[e+1],t.heap[e],t.depth)&&e++,!Mt(n,r,t.heap[e],t.depth));)t.heap[i]=t.heap[e],i=e,e<<=1;t.heap[i]=r},Ct=(t,n,i)=>{var r,e,s,o;let u=0;if(0!==t.sym_next)for(;r=255&t.pending_buf[t.sym_buf+u++],r+=(255&t.pending_buf[t.sym_buf+u++])<<8,e=t.pending_buf[t.sym_buf+u++],0==r?v(t,e,n):(s=Et[e],v(t,s+ot+1,n),0!==(o=_t[s])&&(e-=At[s],h(t,e,o)),r--,s=Ut(r),v(t,s,i),0!==(o=mt[s])&&(r-=St[s],h(t,r,o))),u<t.sym_next;);v(t,dt,n)},Ht=(t,n)=>{var i=n.dyn_tree,r=n.stat_desc.static_tree,e=n.stat_desc.has_stree,s=n.stat_desc.elems;let o,u,f=-1,c;for(t.heap_len=0,t.heap_max=ht,o=0;o<s;o++)0!==i[2*o]?(t.heap[++t.heap_len]=f=o,t.depth[o]=0):i[2*o+1]=0;for(;t.heap_len<2;)i[2*(c=t.heap[++t.heap_len]=f<2?++f:0)]=1,t.depth[c]=0,t.opt_len--,e&&(t.static_len-=r[2*c+1]);for(n.max_code=f,o=t.heap_len>>1;1<=o;o--)zt(t,i,o);for(c=s;o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],zt(t,i,1),u=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=u,i[2*c]=i[2*o]+i[2*u],t.depth[c]=(t.depth[o]>=t.depth[u]?t.depth[o]:t.depth[u])+1,i[2*o+1]=i[2*u+1]=c,t.heap[1]=c++,zt(t,i,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],It(t,n),Lt(i,f,t.bl_count)},Bt=(t,n,i)=>{let r,e=-1;var s;let o=n[1],u=0,f=7,c=4;for(0===o&&(f=138,c=3),n[2*(i+1)+1]=65535,r=0;r<=i;r++)s=o,o=n[2*(r+1)+1],++u<f&&s===o||(u<c?t.bl_tree[2*s]+=u:0!==s?(s!==e&&t.bl_tree[2*s]++,t.bl_tree[2*wt]++):u<=10?t.bl_tree[2*bt]++:t.bl_tree[2*yt]++,u=0,e=s,c=0===o?(f=138,3):s===o?(f=6,3):(f=7,4))},qt=(t,n,i)=>{let r,e=-1;var s;let o=n[1],u=0,f=7,c=4;for(0===o&&(f=138,c=3),r=0;r<=i;r++)if(s=o,o=n[2*(r+1)+1],!(++u<f&&s===o)){if(u<c)for(;v(t,s,t.bl_tree),0!=--u;);else 0!==s?(s!==e&&(v(t,s,t.bl_tree),u--),v(t,wt,t.bl_tree),h(t,u-3,2)):u<=10?(v(t,bt,t.bl_tree),h(t,u-3,3)):(v(t,yt,t.bl_tree),h(t,u-11,7));u=0,e=s,c=0===o?(f=138,3):s===o?(f=6,3):(f=7,4)}},Jt=!1;let Gt=(t,n,i,r)=>{h(t,0+(r?1:0),3),Ft(t),Nt(t,i),Nt(t,~i),i&&t.pending_buf.set(t.window.subarray(n,n+i),t.pending),t.pending+=i};var f={O:t=>{Jt||((()=>{let t,n,i,r,e;var s=new Array(at+1);for(i=0,r=0;r<st-1;r++)for(At[r]=i,t=0;t<1<<_t[r];t++)Et[i++]=r;for(Et[i-1]=r,e=0,r=0;r<16;r++)for(St[r]=e,t=0;t<1<<mt[r];t++)kt[e++]=r;for(e>>=7;r<ft;r++)for(St[r]=e<<7,t=0;t<1<<mt[r]-7;t++)kt[256+e++]=r;for(n=0;n<=at;n++)s[n]=0;for(t=0;t<=143;)u[2*t+1]=8,t++,s[8]++;for(;t<=255;)u[2*t+1]=9,t++,s[9]++;for(;t<=279;)u[2*t+1]=7,t++,s[7]++;for(;t<=287;)u[2*t+1]=8,t++,s[8]++;for(Lt(u,ut+1,s),t=0;t<ft;t++)Ot[2*t+1]=5,Ot[2*t]=Dt(t,5);Rt=new jt(u,_t,ot+1,ut,at),xt=new jt(Ot,mt,0,ft,at),Tt=new jt(new Array(0),pt,0,ct,vt)})(),Jt=!0),t.l_desc=new Zt(t.dyn_ltree,Rt),t.d_desc=new Zt(t.dyn_dtree,xt),t.bl_desc=new Zt(t.bl_tree,Tt),t.bi_buf=0,t.bi_valid=0,Pt(t)},k:Gt,A:(t,n,i,r)=>{let e,s,o=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let n=4093624447,i;for(i=0;i<=31;i++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*i])return it;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return rt;for(i=32;i<ot;i++)if(0!==t.dyn_ltree[2*i])return rt;return it})(t)),Ht(t,t.l_desc),Ht(t,t.d_desc),o=(t=>{let n;for(Bt(t,t.dyn_ltree,t.l_desc.max_code),Bt(t,t.dyn_dtree,t.d_desc.max_code),Ht(t,t.bl_desc),n=ct-1;3<=n&&0===t.bl_tree[2*gt[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),e=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=e&&(e=s)):e=s=i+5,i+4<=e&&-1!==n?Gt(t,n,i,r):4===t.strategy||s===e?(h(t,2+(r?1:0),3),Ct(t,u,Ot)):(h(t,4+(r?1:0),3),((t,n,i,r)=>{let e;for(h(t,n-257,5),h(t,i-1,5),h(t,r-4,4),e=0;e<r;e++)h(t,t.bl_tree[2*gt[e]+1],3);qt(t,t.dyn_ltree,n-1),qt(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),Ct(t,t.dyn_ltree,t.dyn_dtree)),Pt(t),r&&Ft(t)},S:(t,n,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,0===n?t.dyn_ltree[2*i]++:(t.matches++,n--,t.dyn_ltree[2*(Et[i]+ot+1)]++,t.dyn_dtree[2*Ut(n)]++),t.sym_next===t.sym_end),j:t=>{h(t,2,3),v(t,dt,u),16===(t=t).bi_valid?(Nt(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},Kt=(t,n,i,r)=>{let e=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==i;){for(i-=o=2e3<i?2e3:i;e=e+n[r++]|0,s=s+e|0,--o;);e%=65521,s%=65521}return e|s<<16|0};let Wt=new Uint32Array((()=>{let t,n=[];for(var i=0;i<256;i++){t=i;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;n[i]=t}return n})());var K=(n,i,t,r)=>{var e=Wt,s=r+t;n^=-1;for(let t=r;t<s;t++)n=n>>>8^e[255&(n^i[t])];return-1^n},Xt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},n={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};let{O:$t,k:Yt,A:Vt,S:Qt,j:tn}=f,{Z_NO_FLUSH:nn,Z_PARTIAL_FLUSH:rn,Z_FULL_FLUSH:en,Z_FINISH:c,Z_BLOCK:sn,Z_OK:d,Z_STREAM_END:on,Z_STREAM_ERROR:w,Z_DATA_ERROR:un,Z_BUF_ERROR:fn,Z_DEFAULT_COMPRESSION:cn,Z_FILTERED:hn,Z_HUFFMAN_ONLY:an,Z_RLE:ln,Z_FIXED:vn,Z_DEFAULT_STRATEGY:dn,Z_UNKNOWN:wn,Z_DEFLATED:bn}=n,yn=9;let _n=286,mn=30,pn=19,gn=2*_n+1,On=15,b=3,kn=258,y=kn+b+1,En=42,An=57,Sn=69,jn=73,Rn=91,xn=103,Tn=113,Zn=666,_=1,Un=2,Nn=3,Dn=4,In=(t,n)=>(t.msg=Xt[n],n),Ln=t=>2*t-(4<t?9:0),Pn=t=>{let n=t.length;for(;0<=--n;)t[n]=0},Fn=t=>{let n,i,r;var e=t.w_size;for(n=t.hash_size,r=n;i=t.head[--r],t.head[r]=i>=e?i-e:0,--n;);for(n=e,r=n;i=t.prev[--r],t.prev[r]=i>=e?i-e:0,--n;);};let Mn=(t,n,i)=>(n<<t.hash_shift^i)&t.hash_mask,m=t=>{var n=t.state;let i=n.pending;0!==(i=i>t.avail_out?t.avail_out:i)&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+i),t.next_out),t.next_out+=i,n.pending_out+=i,t.total_out+=i,t.avail_out-=i,n.pending-=i,0===n.pending)&&(n.pending_out=0)},p=(t,n)=>{Vt(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,m(t.strm)},g=(t,n)=>{t.pending_buf[t.pending++]=n},zn=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},Cn=(t,n,i,r)=>{let e=t.avail_in;return 0===(e=e>r?r:e)?0:(t.avail_in-=e,n.set(t.input.subarray(t.next_in,t.next_in+e),i),1===t.state.wrap?t.adler=Kt(t.adler,n,e,i):2===t.state.wrap&&(t.adler=K(t.adler,n,e,i)),t.next_in+=e,t.total_in+=e,e)},Hn=(t,n)=>{let i=t.max_chain_length,r=t.strstart,e;var s;let o=t.prev_length,u=t.nice_match;var f=t.strstart>t.w_size-y?t.strstart-(t.w_size-y):0,c=t.window,h=t.w_mask,a=t.prev,l=t.strstart+kn;let v=c[r+o-1],d=c[r+o];t.good_match<=t.prev_length&&(i>>=2),u>t.lookahead&&(u=t.lookahead);do{if(c[(e=n)+o]===d&&c[e+o-1]===v&&c[e]===c[r]&&c[++e]===c[r+1]){for(r+=2,e++;c[++r]===c[++e]&&c[++r]===c[++e]&&c[++r]===c[++e]&&c[++r]===c[++e]&&c[++r]===c[++e]&&c[++r]===c[++e]&&c[++r]===c[++e]&&c[++r]===c[++e]&&r<l;);if(s=kn-(l-r),r=l-kn,s>o){if(t.match_start=n,(o=s)>=u)break;v=c[r+o-1],d=c[r+o]}}}while((n=a[n&h])>f&&0!=--i);return o<=t.lookahead?o:t.lookahead},Bn=t=>{var n=t.w_size;let i,r,e;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-y)&&(t.window.set(t.window.subarray(n,n+n-r),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.strstart<t.insert&&(t.insert=t.strstart),Fn(t),r+=n),0===t.strm.avail_in)break;if(i=Cn(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=i,t.lookahead+t.insert>=b)for(e=t.strstart-t.insert,t.ins_h=t.window[e],t.ins_h=Mn(t,t.ins_h,t.window[e+1]);t.insert&&(t.ins_h=Mn(t,t.ins_h,t.window[e+b-1]),t.prev[e&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=e,e++,t.insert--,!(t.lookahead+t.insert<b)););}while(t.lookahead<y&&0!==t.strm.avail_in)},qn=(t,n)=>{let i=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,r,e,s,o=0;for(var u=t.strm.avail_in;r=65535,s=t.bi_valid+42>>3,!(t.strm.avail_out<s||(s=t.strm.avail_out-s,e=t.strstart-t.block_start,(r=(r=r>e+t.strm.avail_in?e+t.strm.avail_in:r)>s?s:r)<i&&(0===r&&n!==c||n===nn||r!==e+t.strm.avail_in))||(o=n===c&&r===e+t.strm.avail_in?1:0,Yt(t,0,0,o),t.pending_buf[t.pending-4]=r,t.pending_buf[t.pending-3]=r>>8,t.pending_buf[t.pending-2]=~r,t.pending_buf[t.pending-1]=~r>>8,m(t.strm),e&&(e>r&&(e=r),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+e),t.strm.next_out),t.strm.next_out+=e,t.strm.avail_out-=e,t.strm.total_out+=e,t.block_start+=e,r-=e),r&&(Cn(t.strm,t.strm.output,t.strm.next_out,r),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r),0!==o)););return(u-=t.strm.avail_in)&&(u>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=u&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.strstart<t.insert)&&(t.insert=t.strstart),t.window.set(t.strm.input.subarray(t.strm.next_in-u,t.strm.next_in),t.strstart),t.strstart+=u,t.insert+=t.w_size-t.insert<u?t.w_size-t.insert:u),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?Dn:n!==nn&&n!==c&&0===t.strm.avail_in&&t.strstart===t.block_start?Un:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.strstart<t.insert)&&(t.insert=t.strstart),(s=s>t.strm.avail_in?t.strm.avail_in:s)&&(Cn(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,s=65535<t.pending_buf_size-s?65535:t.pending_buf_size-s,i=s>t.w_size?t.w_size:s,((e=t.strstart-t.block_start)>=i||(e||n===c)&&n!==nn&&0===t.strm.avail_in&&e<=s)&&(r=e>s?s:e,o=n===c&&0===t.strm.avail_in&&r===e?1:0,Yt(t,t.block_start,r,o),t.block_start+=r,m(t.strm)),o?Nn:_)};t=(t,n)=>{let i,r;for(;;){if(t.lookahead<y){if(Bn(t),t.lookahead<y&&n===nn)return _;if(0===t.lookahead)break}if(i=0,t.lookahead>=b&&(t.ins_h=Mn(t,t.ins_h,t.window[t.strstart+b-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-y&&(t.match_length=Hn(t,i)),t.match_length>=b)if(r=Qt(t,t.strstart-t.match_start,t.match_length-b),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=b){for(t.match_length--;t.strstart++,t.ins_h=Mn(t,t.ins_h,t.window[t.strstart+b-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Mn(t,t.ins_h,t.window[t.strstart+1]);else r=Qt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(p(t,!1),0===t.strm.avail_out))return _}return t.insert=t.strstart<b-1?t.strstart:b-1,n===c?(p(t,!0),0===t.strm.avail_out?Nn:Dn):t.sym_next&&(p(t,!1),0===t.strm.avail_out)?_:Un},f=(t,n)=>{let i,r;for(var e;;){if(t.lookahead<y){if(Bn(t),t.lookahead<y&&n===nn)return _;if(0===t.lookahead)break}if(i=0,t.lookahead>=b&&(t.ins_h=Mn(t,t.ins_h,t.window[t.strstart+b-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=b-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-y&&(t.match_length=Hn(t,i),t.match_length<=5)&&(t.strategy===hn||t.match_length===b&&4096<t.strstart-t.match_start)&&(t.match_length=b-1),t.prev_length>=b&&t.match_length<=t.prev_length){for(e=t.strstart+t.lookahead-b,r=Qt(t,t.strstart-1-t.prev_match,t.prev_length-b),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=e&&(t.ins_h=Mn(t,t.ins_h,t.window[t.strstart+b-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=b-1,t.strstart++,r&&(p(t,!1),0===t.strm.avail_out))return _}else if(t.match_available){if((r=Qt(t,0,t.window[t.strstart-1]))&&p(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return _}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=Qt(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<b-1?t.strstart:b-1,n===c?(p(t,!0),0===t.strm.avail_out?Nn:Dn):t.sym_next&&(p(t,!1),0===t.strm.avail_out)?_:Un};function O(t,n,i,r,e){this.good_length=t,this.max_lazy=n,this.nice_length=i,this.max_chain=r,this.func=e}let Jn=[new O(0,0,0,0,qn),new O(4,4,8,4,t),new O(4,5,16,8,t),new O(4,6,32,32,t),new O(4,4,16,16,f),new O(8,16,32,32,f),new O(8,16,128,128,f),new O(8,32,128,256,f),new O(32,128,258,1024,f),new O(32,258,258,4096,f)],Gn=t=>{t.window_size=2*t.w_size,Pn(t.head),t.max_lazy_match=Jn[t.level].max_lazy,t.good_match=Jn[t.level].good_length,t.nice_match=Jn[t.level].nice_length,t.max_chain_length=Jn[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=b-1,t.match_available=0,t.ins_h=0};function Kn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=bn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*gn),this.dyn_dtree=new Uint16Array(2*(2*mn+1)),this.bl_tree=new Uint16Array(2*(2*pn+1)),Pn(this.dyn_ltree),Pn(this.dyn_dtree),Pn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(On+1),this.heap=new Uint16Array(2*_n+1),Pn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*_n+1),Pn(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}let Wn=t=>{var n;return!t||!(n=t.state)||n.strm!==t||n.status!==En&&n.status!==An&&n.status!==Sn&&n.status!==jn&&n.status!==Rn&&n.status!==xn&&n.status!==Tn&&n.status!==Zn?1:0},Xn=t=>{if(Wn(t))return In(t,w);t.total_in=t.total_out=0,t.data_type=wn;var n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=2===n.wrap?An:n.wrap?En:Tn,t.adler=2===n.wrap?0:1,n.last_flush=-2,$t(n),d},$n=t=>{var n=Xn(t);return n===d&&Gn(t.state),n};let Yn=(t,n,i,r,e,s)=>{if(!t)return w;let o=1;if(n===cn&&(n=6),r<0?(o=0,r=-r):15<r&&(o=2,r-=16),e<1||e>yn||i!==bn||r<8||15<r||n<0||9<n||s<0||s>vn||8===r&&1!==o)return In(t,w);8===r&&(r=9);var u=new Kn;return(t.state=u).strm=t,u.status=En,u.wrap=o,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=e+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+b-1)/b),u.window=new Uint8Array(2*u.w_size),u.head=new Uint16Array(u.hash_size),u.prev=new Uint16Array(u.w_size),u.lit_bufsize=1<<e+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new Uint8Array(u.pending_buf_size),u.sym_buf=u.lit_bufsize,u.sym_end=3*(u.lit_bufsize-1),u.level=n,u.strategy=s,u.method=i,$n(t)};var Vn={deflateInit:(t,n)=>Yn(t,n,bn,15,8,dn),deflateInit2:Yn,deflateReset:$n,deflateResetKeep:Xn,deflateSetHeader:(t,n)=>Wn(t)||2!==t.state.wrap?w:(t.state.gzhead=n,d),deflate:(i,t)=>{if(Wn(i)||t>sn||t<0)return i?In(i,w):w;var r=i.state;if(!i.output||0!==i.avail_in&&!i.input||r.status===Zn&&t!==c)return In(i,0===i.avail_out?fn:w);var e=r.last_flush;if(r.last_flush=t,0!==r.pending){if(m(i),0===i.avail_out)return r.last_flush=-1,d}else if(0===i.avail_in&&Ln(t)<=Ln(e)&&t!==c)return In(i,fn);if(r.status===Zn&&0!==i.avail_in)return In(i,fn);if(r.status===En&&0===r.wrap&&(r.status=Tn),r.status===En){let t=bn+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=an||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,zn(r,t),0!==r.strstart&&(zn(r,i.adler>>>16),zn(r,65535&i.adler)),i.adler=1,r.status=Tn,m(i),0!==r.pending)return r.last_flush=-1,d}if(r.status===An)if(i.adler=0,g(r,31),g(r,139),g(r,8),r.gzhead)g(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),g(r,255&r.gzhead.time),g(r,r.gzhead.time>>8&255),g(r,r.gzhead.time>>16&255),g(r,r.gzhead.time>>24&255),g(r,9===r.level?2:r.strategy>=an||r.level<2?4:0),g(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(g(r,255&r.gzhead.extra.length),g(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(i.adler=K(i.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Sn;else if(g(r,0),g(r,0),g(r,0),g(r,0),g(r,0),g(r,9===r.level?2:r.strategy>=an||r.level<2?4:0),g(r,3),r.status=Tn,m(i),0!==r.pending)return r.last_flush=-1,d;if(r.status===Sn){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){var s=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+s),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(i.adler=K(i.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=s,m(i),0!==r.pending)return r.last_flush=-1,d;t=0,n-=s}e=new Uint8Array(r.gzhead.extra);r.pending_buf.set(e.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(i.adler=K(i.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=jn}if(r.status===jn){if(r.gzhead.name){let t=r.pending,n;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>t&&(i.adler=K(i.adler,r.pending_buf,r.pending-t,t)),m(i),0!==r.pending)return r.last_flush=-1,d;t=0}}while(n=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,g(r,n),0!==n);r.gzhead.hcrc&&r.pending>t&&(i.adler=K(i.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=Rn}if(r.status===Rn){if(r.gzhead.comment){let t=r.pending,n;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>t&&(i.adler=K(i.adler,r.pending_buf,r.pending-t,t)),m(i),0!==r.pending)return r.last_flush=-1,d;t=0}}while(n=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,g(r,n),0!==n);r.gzhead.hcrc&&r.pending>t&&(i.adler=K(i.adler,r.pending_buf,r.pending-t,t))}r.status=xn}if(r.status===xn){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(m(i),0!==r.pending))return r.last_flush=-1,d;g(r,255&i.adler),g(r,i.adler>>8&255),i.adler=0}if(r.status=Tn,m(i),0!==r.pending)return r.last_flush=-1,d}if(0!==i.avail_in||0!==r.lookahead||t!==nn&&r.status!==Zn){e=0===r.level?qn(r,t):r.strategy===an?((t,n)=>{for(var i;;){if(0===t.lookahead&&(Bn(t),0===t.lookahead)){if(n===nn)return _;break}if(t.match_length=0,i=Qt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(p(t,!1),0===t.strm.avail_out))return _}return t.insert=0,n===c?(p(t,!0),0===t.strm.avail_out?Nn:Dn):t.sym_next&&(p(t,!1),0===t.strm.avail_out)?_:Un})(r,t):r.strategy===ln?((t,n)=>{let i;var r;let e,s;for(var o=t.window;;){if(t.lookahead<=kn){if(Bn(t),t.lookahead<=kn&&n===nn)return _;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=b&&0<t.strstart&&(r=o[e=t.strstart-1])===o[++e]&&r===o[++e]&&r===o[++e]){for(s=t.strstart+kn;r===o[++e]&&r===o[++e]&&r===o[++e]&&r===o[++e]&&r===o[++e]&&r===o[++e]&&r===o[++e]&&r===o[++e]&&e<s;);t.match_length=kn-(s-e),t.lookahead<t.match_length&&(t.match_length=t.lookahead)}if(t.match_length>=b?(i=Qt(t,1,t.match_length-b),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=Qt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(p(t,!1),0===t.strm.avail_out))return _}return t.insert=0,n===c?(p(t,!0),0===t.strm.avail_out?Nn:Dn):t.sym_next&&(p(t,!1),0===t.strm.avail_out)?_:Un})(r,t):Jn[r.level].func(r,t);if(e!==Nn&&e!==Dn||(r.status=Zn),e===_||e===Nn)return 0===i.avail_out&&(r.last_flush=-1),d;if(e===Un&&(t===rn?tn(r):t!==sn&&(Yt(r,0,0,!1),t===en)&&(Pn(r.head),0===r.lookahead)&&(r.strstart=0,r.block_start=0,r.insert=0),m(i),0===i.avail_out))return r.last_flush=-1,d}return t!==c||!(r.wrap<=0)&&(2===r.wrap?(g(r,255&i.adler),g(r,i.adler>>8&255),g(r,i.adler>>16&255),g(r,i.adler>>24&255),g(r,255&i.total_in),g(r,i.total_in>>8&255),g(r,i.total_in>>16&255),g(r,i.total_in>>24&255)):(zn(r,i.adler>>>16),zn(r,65535&i.adler)),m(i),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending)?d:on},deflateEnd:t=>{var n;return Wn(t)?w:(n=t.state.status,t.state=null,n===Tn?In(t,un):d)},deflateSetDictionary:(t,n)=>{let i=n.length;if(Wn(t))return w;var r=t.state,e=r.wrap;if(2===e||1===e&&r.status!==En||r.lookahead)return w;1===e&&(t.adler=Kt(t.adler,n,i,0)),r.wrap=0,i>=r.w_size&&(0===e&&(Pn(r.head),r.strstart=0,r.block_start=0,r.insert=0),(s=new Uint8Array(r.w_size)).set(n.subarray(i-r.w_size,i),0),n=s,i=r.w_size);var s=t.avail_in,o=t.next_in,u=t.input;for(t.avail_in=i,t.next_in=0,t.input=n,Bn(r);r.lookahead>=b;){let t=r.strstart,n=r.lookahead-(b-1);for(;r.ins_h=Mn(r,r.ins_h,r.window[t+b-1]),r.prev[t&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=t,t++,--n;);r.strstart=t,r.lookahead=b-1,Bn(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=b-1,r.match_available=0,t.next_in=o,t.input=u,t.avail_in=s,r.wrap=e,d},deflateInfo:"pako deflate (from Nodeca project)"};var Qn=function(t){for(var n,i,r=Array.prototype.slice.call(arguments,1);r.length;){var e=r.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(var s in e)n=e,i=s,Object.prototype.hasOwnProperty.call(n,i)&&(t[s]=e[s])}}return t},ti=r=>{let i=0;for(let t=0,n=r.length;t<n;t++)i+=r[t].length;var e=new Uint8Array(i);for(let t=0,n=0,i=r.length;t<i;t++){var s=r[t];e.set(s,n),n+=s.length}return e};let ni=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){ni=!1}let ii=new Uint8Array(256);for(let t=0;t<256;t++)ii[t]=252<=t?6:248<=t?5:240<=t?4:224<=t?3:192<=t?2:1;ii[254]=ii[254]=1;var ri=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,i,r,e,s,o=t.length,u=0;for(e=0;e<o;e++)55296==(64512&(i=t.charCodeAt(e)))&&e+1<o&&56320==(64512&(r=t.charCodeAt(e+1)))&&(i=65536+(i-55296<<10)+(r-56320),e++),u+=i<128?1:i<2048?2:i<65536?3:4;for(n=new Uint8Array(u),s=0,e=0;s<u;e++)55296==(64512&(i=t.charCodeAt(e)))&&e+1<o&&56320==(64512&(r=t.charCodeAt(e+1)))&&(i=65536+(i-55296<<10)+(r-56320),e++),i<128?n[s++]=i:(i<2048?n[s++]=192|i>>>6:(i<65536?n[s++]=224|i>>>12:(n[s++]=240|i>>>18,n[s++]=128|i>>>12&63),n[s++]=128|i>>>6&63),n[s++]=128|63&i);return n},ei=(i,t)=>{var r=t||i.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(i.subarray(0,t));let e,s;var o=new Array(2*r);for(s=0,e=0;e<r;){let n=i[e++];if(n<128)o[s++]=n;else{let t=ii[n];if(4<t)o[s++]=65533,e+=t-1;else{for(n&=2===t?31:3===t?15:7;1<t&&e<r;)n=n<<6|63&i[e++],t--;1<t?o[s++]=65533:n<65536?o[s++]=n:(n-=65536,o[s++]=55296|n>>10&1023,o[s++]=56320|1023&n)}}}return((n,i)=>{if(i<65534&&n.subarray&&ni)return String.fromCharCode.apply(null,n.length===i?n:n.subarray(0,i));let r="";for(let t=0;t<i;t++)r+=String.fromCharCode(n[t]);return r})(o,s)},si=(t,n)=>{let i=(n=(n=n||t.length)>t.length?t.length:n)-1;for(;0<=i&&128==(192&t[i]);)i--;return!(i<0)&&0!==i&&i+ii[t[i]]>n?i:n};var oi=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};let ui=Object.prototype.toString,{Z_NO_FLUSH:fi,Z_SYNC_FLUSH:ci,Z_FULL_FLUSH:hi,Z_FINISH:ai,Z_OK:li,Z_STREAM_END:vi,Z_DEFAULT_COMPRESSION:di,Z_DEFAULT_STRATEGY:wi,Z_DEFLATED:bi}=n;function yi(n){this.options=Qn({level:di,method:bi,chunkSize:16384,windowBits:15,memLevel:8,strategy:wi},n||{});var n=this.options,i=(n.raw&&0<n.windowBits?n.windowBits=-n.windowBits:n.gzip&&0<n.windowBits&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new oi,this.strm.avail_out=0,Vn.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy));if(i!==li)throw new Error(Xt[i]);if(n.header&&Vn.deflateSetHeader(this.strm,n.header),n.dictionary){let t;if(t="string"==typeof n.dictionary?ri(n.dictionary):"[object ArrayBuffer]"===ui.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,(i=Vn.deflateSetDictionary(this.strm,t))!==li)throw new Error(Xt[i]);this.R=!0}}function _i(t,n){n=new yi(n);if(n.push(t,!0),n.err)throw n.msg||Xt[n.err];return n.result}yi.prototype.push=function(t,n){var i=this.strm,r=this.options.chunkSize;let e,s;if(this.ended)return!1;for(s=n===~~n?n:!0===n?ai:fi,"string"==typeof t?i.input=ri(t):"[object ArrayBuffer]"===ui.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),(s===ci||s===hi)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(Vn.deflate(i,s)===vi)return 0<i.next_out&&this.onData(i.output.subarray(0,i.next_out)),e=Vn.deflateEnd(this.strm),this.onEnd(e),this.ended=!0,e===li;if(0===i.avail_out)this.onData(i.output);else if(0<s&&0<i.next_out)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}return!0},yi.prototype.onData=function(t){this.chunks.push(t)},yi.prototype.onEnd=function(t){t===li&&(this.result=ti(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function mi(t,n){return(n=n||{}).raw=!0,_i(t,n)}function pi(t,n){return(n=n||{}).gzip=!0,_i(t,n)}let gi=yi,Oi=_i,ki=n,Ei={Deflate:gi,deflate:Oi,deflateRaw:mi,gzip:pi,constants:ki},Ai=16209,Si=16191;let ji=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ri=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),xi=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ti=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Zi=(t,n,i,r,e,s,o,u)=>{var f,c=u.bits;let h=0,a=0,l=0,v=0,d=0,w=0,b=0,y=0,_=0,m=0,p,g,O,k,E=null,A;var S=new Uint16Array(16),j=new Uint16Array(16);let R=null,x,T,Z;for(h=0;h<=15;h++)S[h]=0;for(a=0;a<r;a++)S[n[i+a]]++;for(d=c,v=15;1<=v&&0===S[v];v--);if(d>v&&(d=v),0===v)e[s++]=20971520,e[s++]=20971520,u.bits=1;else{for(l=1;l<v&&0===S[l];l++);for(d<l&&(d=l),y=1,h=1;h<=15;h++)if((y=(y<<=1)-S[h])<0)return-1;if(0<y&&(0===t||1!==v))return-1;for(j[1]=0,h=1;h<15;h++)j[h+1]=j[h]+S[h];for(a=0;a<r;a++)0!==n[i+a]&&(o[j[n[i+a]]++]=a);if(A=0===t?(E=R=o,20):1===t?(E=ji,R=Ri,257):(E=xi,R=Ti,0),m=0,a=0,h=l,k=s,w=d,b=0,O=-1,f=(_=1<<d)-1,1===t&&852<_||2===t&&592<_)return 1;for(;;){for(x=h-b,Z=o[a]+1<A?(T=0,o[a]):o[a]>=A?(T=R[o[a]-A],E[o[a]-A]):(T=96,0),p=1<<h-b,g=1<<w,l=g;g-=p,e[k+(m>>b)+g]=x<<24|T<<16|Z|0,0!==g;);for(p=1<<h-1;m&p;)p>>=1;if(m=0!==p?(m&=p-1)+p:0,a++,0==--S[h]){if(h===v)break;h=n[i+o[a]]}if(h>d&&(m&f)!==O){for(0===b&&(b=d),k+=l,w=h-b,y=1<<w;w+b<v&&!((y-=S[w+b])<=0);)w++,y<<=1;if(_+=1<<w,1===t&&852<_||2===t&&592<_)return 1;e[O=m&f]=d<<24|w<<16|k-s|0}}0!==m&&(e[k+m]=h-b<<24|64<<16|0),u.bits=d}return 0};let Ui=1,Ni=2,{Z_FINISH:Di,Z_BLOCK:Ii,Z_TREES:Li,Z_OK:Pi,Z_STREAM_END:Fi,Z_NEED_DICT:Mi,Z_STREAM_ERROR:W,Z_DATA_ERROR:zi,Z_MEM_ERROR:Ci,Z_BUF_ERROR:Hi,Z_DEFLATED:Bi}=n,qi=16180,Ji=16190,X=16191,Gi=16199,Ki=16200,$=16209,Wi=16211,Xi=852,$i=592;let Yi=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Vi(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let Qi=t=>{var n;return!t||!(n=t.state)||n.strm!==t||n.mode<qi||n.mode>Wi?1:0},tr=t=>{var n;return Qi(t)?W:(n=t.state,t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=qi,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(Xi),n.distcode=n.distdyn=new Int32Array($i),n.sane=1,n.back=-1,Pi)},nr=t=>{var n;return Qi(t)?W:((n=t.state).wsize=0,n.whave=0,n.wnext=0,tr(t))},ir=(t,n)=>{let i;var r;return Qi(t)||(r=t.state,n<0?(i=0,n=-n):(i=5+(n>>4),n<48&&(n&=15)),n&&(n<8||15<n))?W:(null!==r.window&&r.wbits!==n&&(r.window=null),r.wrap=i,r.wbits=n,nr(t))},rr=(t,n)=>{var i;return t?(i=new Vi,(t.state=i).strm=t,i.window=null,i.mode=qi,(i=ir(t,n))!==Pi&&(t.state=null),i):W};let er=!0,sr,or,ur=(t,n,i,r)=>{let e;t=t.state;return null===t.window&&(t.wsize=1<<t.wbits,t.wnext=0,t.whave=0,t.window=new Uint8Array(t.wsize)),t.wsize<=r?(t.window.set(n.subarray(i-t.wsize,i),0),t.wnext=0,t.whave=t.wsize):((e=t.wsize-t.wnext)>r&&(e=r),t.window.set(n.subarray(i-r,i-r+e),t.wnext),(r-=e)?(t.window.set(n.subarray(i-r,i),0),t.wnext=r,t.whave=t.wsize):(t.wnext+=e,t.wnext===t.wsize&&(t.wnext=0),t.whave<t.wsize&&(t.whave+=e))),0};var k={inflateReset:nr,inflateReset2:ir,inflateResetKeep:tr,inflateInit:t=>rr(t,15),inflateInit2:rr,inflate:(c,t)=>{var n;let i,r,e,s,o,u,f,h,a,l,v,L,P,d=0,w,b,y,_,m,p,g,O;var k=new Uint8Array(4);let E,A;var S,F,j,M,R,z,x,T,C,H,B,q,Z,U,N,J=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Qi(c)||!c.output||!c.input&&0!==c.avail_in)return W;(n=c.state).mode===X&&(n.mode=16192),s=c.next_out,r=c.output,u=c.avail_out,e=c.next_in,i=c.input,o=c.avail_in,f=n.hold,h=n.bits,a=o,l=u,O=Pi;t:for(;;)switch(n.mode){case qi:if(0===n.wrap)n.mode=16192;else{for(;h<16;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}2&n.wrap&&35615===f?(0===n.wbits&&(n.wbits=15),k[n.check=0]=255&f,k[1]=f>>>8&255,n.check=K(n.check,k,2,0),f=0,h=0,n.mode=16181):(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&f)<<8)+(f>>8))%31?(c.msg="incorrect header check",n.mode=$):(15&f)!==Bi?(c.msg="unknown compression method",n.mode=$):(f>>>=4,h-=4,g=8+(15&f),0===n.wbits&&(n.wbits=g),15<g||g>n.wbits?(c.msg="invalid window size",n.mode=$):(n.dmax=1<<n.wbits,n.flags=0,c.adler=n.check=1,n.mode=512&f?16189:X,f=0,h=0)))}break;case 16181:for(;h<16;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if(n.flags=f,(255&n.flags)!==Bi){c.msg="unknown compression method",n.mode=$;break}if(57344&n.flags){c.msg="unknown header flags set",n.mode=$;break}n.head&&(n.head.text=f>>8&1),512&n.flags&&4&n.wrap&&(k[0]=255&f,k[1]=f>>>8&255,n.check=K(n.check,k,2,0)),f=0,h=0,n.mode=16182;case 16182:for(;h<32;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}n.head&&(n.head.time=f),512&n.flags&&4&n.wrap&&(k[0]=255&f,k[1]=f>>>8&255,k[2]=f>>>16&255,k[3]=f>>>24&255,n.check=K(n.check,k,4,0)),f=0,h=0,n.mode=16183;case 16183:for(;h<16;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}n.head&&(n.head.xflags=255&f,n.head.os=f>>8),512&n.flags&&4&n.wrap&&(k[0]=255&f,k[1]=f>>>8&255,n.check=K(n.check,k,2,0)),f=0,h=0,n.mode=16184;case 16184:if(1024&n.flags){for(;h<16;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}n.length=f,n.head&&(n.head.extra_len=f),512&n.flags&&4&n.wrap&&(k[0]=255&f,k[1]=f>>>8&255,n.check=K(n.check,k,2,0)),f=0,h=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&((v=(v=n.length)>o?o:v)&&(n.head&&(g=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(e,e+v),g)),512&n.flags&&4&n.wrap&&(n.check=K(n.check,i,v,e)),o-=v,e+=v,n.length-=v),n.length))break t;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===o)break t;for(v=0;g=i[e+v++],n.head&&g&&n.length<65536&&(n.head.name+=String.fromCharCode(g)),g&&v<o;);if(512&n.flags&&4&n.wrap&&(n.check=K(n.check,i,v,e)),o-=v,e+=v,g)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===o)break t;for(v=0;g=i[e+v++],n.head&&g&&n.length<65536&&(n.head.comment+=String.fromCharCode(g)),g&&v<o;);if(512&n.flags&&4&n.wrap&&(n.check=K(n.check,i,v,e)),o-=v,e+=v,g)break t}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;h<16;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if(4&n.wrap&&f!==(65535&n.check)){c.msg="header crc mismatch",n.mode=$;break}f=0,h=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),c.adler=n.check=0,n.mode=X;break;case 16189:for(;h<32;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}c.adler=n.check=Yi(f),f=0,h=0,n.mode=Ji;case Ji:if(0===n.havedict)return c.next_out=s,c.avail_out=u,c.next_in=e,c.avail_in=o,n.hold=f,n.bits=h,Mi;c.adler=n.check=1,n.mode=X;case X:if(t===Ii||t===Li)break t;case 16192:if(n.last)f>>>=7&h,h-=7&h,n.mode=16206;else{for(;h<3;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}switch(n.last=1&f,f>>>=1,--h,3&f){case 0:n.mode=16193;break;case 1:if((n=>{if(er){sr=new Int32Array(512),or=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(Zi(Ui,n.lens,0,288,sr,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;Zi(Ni,n.lens,0,32,or,0,n.work,{bits:5}),er=!1}n.lencode=sr,n.lenbits=9,n.distcode=or,n.distbits=5})(n),n.mode=Gi,t!==Li)break;f>>>=2,h-=2;break t;case 2:n.mode=16196;break;case 3:c.msg="invalid block type",n.mode=$}f>>>=2,h-=2}break;case 16193:for(f>>>=7&h,h-=7&h;h<32;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if((65535&f)!=(f>>>16^65535)){c.msg="invalid stored block lengths",n.mode=$;break}if(n.length=65535&f,f=0,h=0,n.mode=16194,t===Li)break t;case 16194:n.mode=16195;case 16195:if(v=n.length){if(0===(v=(v=v>o?o:v)>u?u:v))break t;r.set(i.subarray(e,e+v),s),o-=v,e+=v,u-=v,s+=v,n.length-=v}else n.mode=X;break;case 16196:for(;h<14;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if(n.nlen=257+(31&f),f>>>=5,h-=5,n.ndist=1+(31&f),f>>>=5,h-=5,n.ncode=4+(15&f),f>>>=4,h-=4,286<n.nlen||30<n.ndist){c.msg="too many length or distance symbols",n.mode=$;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;h<3;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}n.lens[J[n.have++]]=7&f,f>>>=3,h-=3}for(;n.have<19;)n.lens[J[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,E={bits:n.lenbits},O=Zi(0,n.lens,0,19,n.lencode,0,n.work,E),n.lenbits=E.bits,O){c.msg="invalid code lengths set",n.mode=$;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;d=n.lencode[f&(1<<n.lenbits)-1],w=d>>>24,b=d>>>16&255,y=65535&d,!(w<=h);){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if(y<16)f>>>=w,h-=w,n.lens[n.have++]=y;else{if(16===y){for(A=w+2;h<A;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if(f>>>=w,h-=w,0===n.have){c.msg="invalid bit length repeat",n.mode=$;break}g=n.lens[n.have-1],v=3+(3&f),f>>>=2,h-=2}else if(17===y){for(A=w+3;h<A;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}f>>>=w,h-=w,g=0,v=3+(7&f),f>>>=3,h-=3}else{for(A=w+7;h<A;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}f>>>=w,h-=w,g=0,v=11+(127&f),f>>>=7,h-=7}if(n.have+v>n.nlen+n.ndist){c.msg="invalid bit length repeat",n.mode=$;break}for(;v--;)n.lens[n.have++]=g}}if(n.mode===$)break;if(0===n.lens[256]){c.msg="invalid code -- missing end-of-block",n.mode=$;break}if(n.lenbits=9,E={bits:n.lenbits},O=Zi(Ui,n.lens,0,n.nlen,n.lencode,0,n.work,E),n.lenbits=E.bits,O){c.msg="invalid literal/lengths set",n.mode=$;break}if(n.distbits=6,n.distcode=n.distdyn,E={bits:n.distbits},O=Zi(Ni,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,E),n.distbits=E.bits,O){c.msg="invalid distances set",n.mode=$;break}if(n.mode=Gi,t===Li)break t;case Gi:n.mode=Ki;case Ki:if(6<=o&&258<=u){c.next_out=s,c.avail_out=u,c.next_in=e,c.avail_in=o,n.hold=f,n.bits=h;{D=void 0;G=void 0;S=void 0;F=void 0;j=void 0;M=void 0;R=void 0;z=void 0;x=void 0;T=void 0;C=void 0;H=void 0;B=void 0;q=void 0;Z=void 0;U=void 0;N=void 0;I=void 0;var D=c;var G=l;let t;let n,i,r,e,s,o,u,f;var I=D.state;t=D.next_in,U=D.input,S=t+(D.avail_in-5),n=D.next_out,N=D.output,F=n-(G-D.avail_out),j=n+(D.avail_out-257),M=I.dmax,R=I.wsize,z=I.whave,x=I.wnext,T=I.window,i=I.hold,r=I.bits,C=I.lencode,H=I.distcode,B=(1<<I.lenbits)-1,q=(1<<I.distbits)-1;n:do{for(r<15&&(i+=U[t++]<<r,r+=8,i+=U[t++]<<r,r+=8),e=C[i&B];;){if(s=e>>>24,i>>>=s,r-=s,0===(s=e>>>16&255))N[n++]=65535&e;else{if(!(16&s)){if(0==(64&s)){e=C[(65535&e)+(i&(1<<s)-1)];continue}if(32&s){I.mode=Si;break n}D.msg="invalid literal/length code",I.mode=Ai;break n}for(o=65535&e,(s&=15)&&(r<s&&(i+=U[t++]<<r,r+=8),o+=i&(1<<s)-1,i>>>=s,r-=s),r<15&&(i+=U[t++]<<r,r+=8,i+=U[t++]<<r,r+=8),e=H[i&q];;){if(s=e>>>24,i>>>=s,r-=s,!(16&(s=e>>>16&255))){if(0==(64&s)){e=H[(65535&e)+(i&(1<<s)-1)];continue}D.msg="invalid distance code",I.mode=Ai;break n}if(Z=65535&e,s&=15,r<s&&(i+=U[t++]<<r,(r+=8)<s)&&(i+=U[t++]<<r,r+=8),M<(Z+=i&(1<<s)-1)){D.msg="invalid distance too far back",I.mode=Ai;break n}if(i>>>=s,r-=s,Z>(s=n-F)){if((s=Z-s)>z&&I.sane){D.msg="invalid distance too far back",I.mode=Ai;break n}if(u=0,f=T,0===x){if(u+=R-s,s<o){for(o-=s;N[n++]=T[u++],--s;);u=n-Z,f=N}}else if(x<s){if(u+=R+x-s,(s-=x)<o){for(o-=s;N[n++]=T[u++],--s;);if(u=0,x<o){for(s=x,o-=s;N[n++]=T[u++],--s;);u=n-Z,f=N}}}else if(u+=x-s,s<o){for(o-=s;N[n++]=T[u++],--s;);u=n-Z,f=N}for(;2<o;)N[n++]=f[u++],N[n++]=f[u++],N[n++]=f[u++],o-=3;o&&(N[n++]=f[u++],1<o)&&(N[n++]=f[u++])}else{for(u=n-Z;N[n++]=N[u++],N[n++]=N[u++],N[n++]=N[u++],2<(o-=3););o&&(N[n++]=N[u++],1<o)&&(N[n++]=N[u++])}break}}break}}while(t<S&&n<j);o=r>>3,t-=o,r-=o<<3,i&=(1<<r)-1,D.next_in=t,D.next_out=n,D.avail_in=t<S?S-t+5:5-(t-S),D.avail_out=n<j?j-n+257:257-(n-j),I.hold=i,I.bits=r}s=c.next_out,r=c.output,u=c.avail_out,e=c.next_in,i=c.input,o=c.avail_in,f=n.hold,h=n.bits,n.mode===X&&(n.back=-1);break}for(n.back=0;d=n.lencode[f&(1<<n.lenbits)-1],w=d>>>24,b=d>>>16&255,y=65535&d,!(w<=h);){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if(b&&0==(240&b)){for(_=w,m=b,p=y;d=n.lencode[p+((f&(1<<_+m)-1)>>_)],w=d>>>24,b=d>>>16&255,y=65535&d,!(_+w<=h);){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}f>>>=_,h-=_,n.back+=_}if(f>>>=w,h-=w,n.back+=w,n.length=y,0===b){n.mode=16205;break}if(32&b){n.back=-1,n.mode=X;break}if(64&b){c.msg="invalid literal/length code",n.mode=$;break}n.extra=15&b,n.mode=16201;case 16201:if(n.extra){for(A=n.extra;h<A;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}n.length+=f&(1<<n.extra)-1,f>>>=n.extra,h-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;d=n.distcode[f&(1<<n.distbits)-1],w=d>>>24,b=d>>>16&255,y=65535&d,!(w<=h);){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if(0==(240&b)){for(_=w,m=b,p=y;d=n.distcode[p+((f&(1<<_+m)-1)>>_)],w=d>>>24,b=d>>>16&255,y=65535&d,!(_+w<=h);){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}f>>>=_,h-=_,n.back+=_}if(f>>>=w,h-=w,n.back+=w,64&b){c.msg="invalid distance code",n.mode=$;break}n.offset=y,n.extra=15&b,n.mode=16203;case 16203:if(n.extra){for(A=n.extra;h<A;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}n.offset+=f&(1<<n.extra)-1,f>>>=n.extra,h-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){c.msg="invalid distance too far back",n.mode=$;break}n.mode=16204;case 16204:if(0===u)break t;if(v=l-u,n.offset>v){if((v=n.offset-v)>n.whave&&n.sane){c.msg="invalid distance too far back",n.mode=$;break}L=v>n.wnext?(v-=n.wnext,n.wsize-v):n.wnext-v,v>n.length&&(v=n.length),P=n.window}else P=r,L=s-n.offset,v=n.length;for(v>u&&(v=u),u-=v,n.length-=v;r[s++]=P[L++],--v;);0===n.length&&(n.mode=Ki);break;case 16205:if(0===u)break t;r[s++]=n.length,u--,n.mode=Ki;break;case 16206:if(n.wrap){for(;h<32;){if(0===o)break t;o--,f|=i[e++]<<h,h+=8}if(l-=u,c.total_out+=l,n.total+=l,4&n.wrap&&l&&(c.adler=n.check=(n.flags?K:Kt)(n.check,r,l,s-l)),l=u,4&n.wrap&&(n.flags?f:Yi(f))!==n.check){c.msg="incorrect data check",n.mode=$;break}f=0,h=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;h<32;){if(0===o)break t;o--,f+=i[e++]<<h,h+=8}if(4&n.wrap&&f!==(4294967295&n.total)){c.msg="incorrect length check",n.mode=$;break}f=0,h=0}n.mode=16208;case 16208:O=Fi;break t;case $:O=zi;break t;case 16210:return Ci;default:Wi;return W}return c.next_out=s,c.avail_out=u,c.next_in=e,c.avail_in=o,n.hold=f,n.bits=h,(n.wsize||l!==c.avail_out&&n.mode<$&&(n.mode<16206||t!==Di))&&ur(c,c.output,c.next_out,l-c.avail_out),a-=c.avail_in,l-=c.avail_out,c.total_in+=a,c.total_out+=l,n.total+=l,4&n.wrap&&l&&(c.adler=n.check=(n.flags?K:Kt)(n.check,r,l,c.next_out-l)),c.data_type=n.bits+(n.last?64:0)+(n.mode===X?128:0)+(n.mode===Gi||16194===n.mode?256:0),O=(0==a&&0===l||t===Di)&&O===Pi?Hi:O},inflateEnd:t=>{var n;return Qi(t)?W:((n=t.state).window&&(n.window=null),t.state=null,Pi)},inflateGetHeader:(t,n)=>Qi(t)||0==(2&(t=t.state).wrap)?W:((t.head=n).done=!1,Pi),inflateSetDictionary:(t,n)=>{var i,r=n.length;return Qi(t)||0!==(i=t.state).wrap&&i.mode!==Ji?W:i.mode===Ji&&Kt(1,n,r,0)!==i.check?zi:ur(t,n,r,r)?(i.mode=16210,Ci):(i.havedict=1,Pi)},inflateInfo:"pako inflate (from Nodeca project)"};var fr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};let cr=Object.prototype.toString,{Z_NO_FLUSH:hr,Z_FINISH:ar,Z_OK:lr,Z_STREAM_END:vr,Z_NEED_DICT:dr,Z_STREAM_ERROR:wr,Z_DATA_ERROR:br,Z_MEM_ERROR:yr}=n;function _r(t){this.options=Qn({chunkSize:65536,windowBits:15,to:""},t||{});var n=this.options,t=(n.raw&&0<=n.windowBits&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits)&&(n.windowBits=-15),!(0<=n.windowBits&&n.windowBits<16)||t&&t.windowBits||(n.windowBits+=32),15<n.windowBits&&n.windowBits<48&&0==(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new oi,this.strm.avail_out=0,k.inflateInit2(this.strm,n.windowBits));if(t!==lr)throw new Error(Xt[t]);if(this.header=new fr,k.inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=ri(n.dictionary):"[object ArrayBuffer]"===cr.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw)&&(t=k.inflateSetDictionary(this.strm,n.dictionary))!==lr)throw new Error(Xt[t])}function mr(t,n){n=new _r(n);if(n.push(t),n.err)throw n.msg||Xt[n.err];return n.result}_r.prototype.push=function(t,n){var i,r,e,s=this.strm,o=this.options.chunkSize,u=this.options.dictionary;let f,c,h;if(this.ended)return!1;for(c=n===~~n?n:!0===n?ar:hr,"[object ArrayBuffer]"===cr.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(o),s.next_out=0,s.avail_out=o),(f=k.inflate(s,c))===dr&&u&&((f=k.inflateSetDictionary(s,u))===lr?f=k.inflate(s,c):f===br&&(f=dr));0<s.avail_in&&f===vr&&0<s.state.wrap&&0!==t[s.next_in];)k.inflateReset(s),f=k.inflate(s,c);switch(f){case wr:case br:case dr:case yr:return this.onEnd(f),!(this.ended=!0)}if(h=s.avail_out,!s.next_out||0!==s.avail_out&&f!==vr||("string"===this.options.to?(i=si(s.output,s.next_out),r=s.next_out-i,e=ei(s.output,i),s.next_out=r,s.avail_out=o-r,r&&s.output.set(s.output.subarray(i,i+r),0),this.onData(e)):this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out))),f!==lr||0!==h){if(f===vr)return f=k.inflateEnd(this.strm),this.onEnd(f),this.ended=!0;if(0===s.avail_in)break}}return!0},_r.prototype.onData=function(t){this.chunks.push(t)},_r.prototype.onEnd=function(t){t===lr&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ti(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var t=Ei.deflate,f={inflate:mr}.inflate,pr=t,gr=f,Or=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},kr=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}};function Er(e,s,o){return Or(this,void 0,void 0,function(){var n,i,r;return kr(this,function(t){switch(t.label){case 0:return n="",i=(t=>{t=t||32;for(var n="abcdefhijkmnprstwxyz0123456789",i=n.length,r="",e=0;e<t;e++)r+=n.charAt(Math.floor(Math.random()*i));return r})(16),[4,function(r){var e;return Or(this,void 0,void 0,function(){var n,i;return kr(this,function(t){switch(t.label){case 0:return n=(new TextEncoder).encode(r),[4,null==(e=crypto.subtle)?void 0:e.digest("SHA-256",n)];case 1:return n=t.sent(),i=Array.from(new Uint8Array(n)),[2,i.map(function(t){return t.toString(16).padStart(2,"0")}).join("")]}})})}("".concat(e).concat("DPIV9g5X2zvTD4Zj").concat(i).concat(o))];case 1:return(r=(r=t.sent()).toLocaleLowerCase())&&(r={ver:s,hash:r,nonce:i,expire:o},r=JSON.stringify(r),n=btoa(r)),[2,n]}})})}var Ar=function(){return(Ar=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Sr=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},jr=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}},Rr=function(t,n,i){if(i||2===arguments.length)for(var r,e=0,s=n.length;e<s;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},xr=(Object.defineProperty(E.prototype,"url",{get:function(){return this.T.url},set:function(t){this.T.url=t},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"strategy",{get:function(){return this.Z.strategy},enumerable:!1,configurable:!0}),E.prototype.setStrategy=function(t){this.Z.setStrategy(t),this.U=this.Z.build()},E.prototype.addRemoteWsLog=function(t){if(this.T.env!=o.BROWSER)throw new Error("cannot use net strategy on  mini program");for(this.N.push(t);this.N.size()>this.N.logCacheMax;)this.N.pop();this.connected()&&this.U&&this.U.active()},E.prototype.stopWebSocketServer=function(){this.clearHbTimer(),this.D=void 0,this.g&&(this.g.onclose=null,this.g.onerror=null,this.g.close(),this.g=null)},E.prototype.I=function(){this.g&&this.T.useStrategy&&(this.Z.setCache(this.N),this.U=this.Z.build())},E.prototype.L=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=this.P=this.F,e="";switch(t){case"onconnecting":"never_opened"===this.F?this.F="first_connecting":this.F="reconnecting";break;case"onopen":this.F="connected",this.onSocketConnect();break;case"onclosed":this.F="closed";var s=n[0];s&&(e+=" close code=".concat(s.code)),this.onSocketClose();break;case"onerror":this.F="error",this.onSocketError()}t=H.WEBSOCKET_STATE_CHANGE+" log ws state change: ".concat(r," -> ").concat(this.F);e&&(t+=e),"error"===this.F?this.M.warn(t):this.M.info(t)},E.prototype.onSocketConnect=function(){},E.prototype.onSocketClose=function(){},E.prototype.onSocketError=function(){},E.prototype.onHeartBeatTimeout=function(){},E.prototype.openWebSocketLogServer=function(t,n,i,r){var e=this;void 0===n&&(n=!1),void 0===i&&(i=!1),""!==t&&(i||this.url!=t)&&((this.url&&""!==this.url||"never_opened"===this.F)&&this.M.info(H.OPEN_WS+" log url change to: ".concat(t)),this.url=t)&&(i=function(){e.C&&(clearTimeout(e.C),e.C=null),e.stopWebSocketServer(),e.g=M(t,e.T.env,e.H),e.g instanceof WebSocket&&(e.g.binaryType="arraybuffer"),e.I(),e.L("onconnecting"),e.g.onopen=function(){var t;e.B=!1,e.D=void 0,e.T.useStrategy&&null!=(t=e.U)&&t.active(),e.L("onopen")},e.g.onclose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.B=!1,e.L.apply(e,Rr(["onclosed"],t,!1))},e.g.onmessage=e.q.bind(e),e.g.onerror=function(){for(var t=0;t<arguments.length;t++)t,0;e.L("onerror")}},n?i():(n="error"===this.F||"error"===this.P,this.C||(this.C=setTimeout(i,r||(n?5e3:3e3)))))},E.prototype.resetSocketTimer=function(){this.C&&(clearTimeout(this.C),this.C=null)},E.prototype.closed=function(){return null==this.g||2==this.g.readyState||3==this.g.readyState},E.prototype.connected=function(){return null!==this.g&&1==this.g.readyState},E.prototype.connecting=function(){return null!==this.g&&0==this.g.readyState},Object.defineProperty(E.prototype,"canSendWs",{get:function(){var t=this.D,t=!t||performance.now()-t<5e3;return!(!this.g||1!==this.g.readyState)&&t},enumerable:!1,configurable:!0}),E.prototype.sendLogFrame=function(i){var r;return Sr(this,void 0,void 0,function(){var n;return jr(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.makeLogFrame(i)];case 1:return n=t.sent(),this.connected()?(null!=(r=this.g)&&r.send(n),[2,!0]):[2,!1];case 2:return t.sent(),[2,!0];case 3:return[2]}})})},E.prototype.makeLogFrame=function(o){return Sr(this,void 0,void 0,function(){var n,i,r,e,s;return jr(this,function(t){switch(t.label){case 0:return e=pr(o),i=this.T,n=i.appid,i=i.userid,r=this.seq++,e={detail_data:e},this.B?[3,2]:[4,function(r){return Or(this,void 0,void 0,function(){var n,i;return kr(this,function(t){switch(t.label){case 0:return n="",i=Math.floor((Date.now()+7776e6)/1e3),[4,Er(r,2,i)];case 1:return i=t.sent(),[2,n=0<i.length?i:n]}})})}(n)];case 1:if(!(s=t.sent()))throw new Error("litesign error");e=Ar(Ar({},e),{appid:n,product:2,id_name:i,timestamp:Math.floor(Date.now()/1e3),litesign:s}),t.label=2;case 2:return s=nt.rtcreport.DetailLogRequest.encode(e).finish(),this.B=!0,[2,this.J(r,7,s)]}})})},E.prototype.J=function(t,n,i){var r=(null==i?void 0:i.length)||0,e=new Uint8Array(10+r);return e[0]=64,e[1]=n,e[2]=t>>24&255,e[3]=t>>16&255,e[4]=t>>8&255,e[5]=255&t,e[6]=r>>24&255,e[7]=r>>16&255,e[8]=r>>8&255,e[9]=255&r,i&&e.set(i,10),e},E.prototype.q=function(t){var t=new Uint8Array(t.data),n=t[0];this.D=performance.now(),this.startHbTimer(),64===n&&8===t[1]&&(t[2],t[3],t[4],t[5],n=t[6]<<24|t[7]<<16|t[8]<<8|t[9],t=new Uint8Array(t.slice(10,10+n)),101===nt.rtcreport.DetailLogResponse.decode(t).code)&&(this.B=!1)},E.prototype.clearLogCacheAndUpload=function(){var n=this;this.connected()&&this.N.clear().forEach(function(t){n.sendLogFrame(t)})},E.prototype.clearHbTimer=function(){this.checkHbTimer&&(clearTimeout(this.checkHbTimer),this.checkHbTimer=void 0)},E.prototype.startHbTimer=function(){var n=this;this.clearHbTimer(),void 0!==this.D&&15e3<performance.now()-this.D?this.onHeartBeatTimeout():this.checkHbTimer=setTimeout(function(){var t;n.g&&(t=n.J(n.seq++,5),n.g.send(t),n.startHbTimer())},5e3)},E.prototype.destroy=function(){this.g=null},E);function E(t,n,i,r){this.N=t,this.T=n,this.M=i,this.H=r,this.g=null,this.F="never_opened",this.P="never_opened",this.Z=new Qr(this),this.U=null,this.B=!1,this.C=null,this.seq=1,this.D=void 0,this.checkHbTimer=void 0}Zr.prototype.active=function(){var i=this;this.G.canSendWs&&0!==this.N.size()&&this.K.canSendLog()&&(this.K.getLog().forEach(function(n){i.G.sendLogFrame(n).then(function(t){t||i.K.cacheLog(n)})}),this.K.onSendLog())};var Tr=Zr;function Zr(t,n,i){this.G=t,this.N=n,this.K=i,this.K.onCanSendActive=this.active.bind(this)}function Ur(t){this.cache=t}Nr=function(t,n){return(Nr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)};(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}Nr(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)})(Lr,Dr=Ur),Lr.prototype.getLog=function(){return this.cache.clear()},Lr.prototype.canSendLog=function(){return 0<this.cache.size()},Lr.prototype.onSendLog=function(){},Lr.prototype.cacheLog=function(t){this.cache.push(t)};var Nr,Dr,Ir=Lr;function Lr(t){return Dr.call(this,t)||this}Pr=function(t,n){return(Pr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)};(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}Pr(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)})(Mr,Fr=Ur),Mr.prototype.canSendLog=function(){return!this.locked&&0<this.cache.size()},Mr.prototype.getLog=function(){for(var t=[],n=0;n<this.maxPacketLen-4e3;){var i=this.cache.getOneLogPacket();if(!i||i.length<=0)break;n+=i.length||0,t.push(i)}return t},Mr.prototype.onSendLog=function(){var t=this;this.locked=!0,setTimeout(function(){t.locked=!1,t.onCanSendActive&&t.onCanSendActive()},this.maxDelay)},Mr.prototype.cacheLog=function(t){this.cache.push(t)};var Pr,Fr,n=Mr;function Mr(){var t=null!==Fr&&Fr.apply(this,arguments)||this;return t.maxDelay=10,t.maxPacketLen=20480,t.locked=!1,t}zr=function(t,n){return(zr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)};(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}zr(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)})(Br,Cr=n);var zr,Cr,Hr=Br;function Br(t){t=Cr.call(this,t)||this;return t.maxDelay=10,t.maxPacketLen=20480,t}qr=function(t,n){return(qr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)};var qr,Jr;(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}qr(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)})(Gr,Jr=n);function Gr(){return null!==Jr&&Jr.apply(this,arguments)||this}Kr=function(t,n){return(Kr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)};var Kr,Wr;(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}Kr(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)})(Xr,Wr=n);function Xr(){return null!==Wr&&Wr.apply(this,arguments)||this}$r=function(t,n){return($r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)};var $r,Yr;(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}$r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)})(Vr,Yr=n);function Vr(){return null!==Yr&&Yr.apply(this,arguments)||this}Object.defineProperty(te.prototype,"strategy",{get:function(){return this.K},enumerable:!1,configurable:!0}),te.prototype.setCache=function(t){this.N=t},te.prototype.setStrategy=function(t){t&&(this.K=t)},te.prototype.build=function(){if(this.N)return this.K!==N.DEFAULT?new Tr(this.G,this.N,new Ir(this.N)):new Tr(this.G,this.N,new Hr(this.N));throw new Error("cannot build log sender")};var Qr=te;function te(t){this.G=t,this.K=N.DEFAULT}A.W=function(){return!(!window||!window.localStorage)},A.bin2hex=function(t){for(var n,i="",r=0,e=(t+="").length;r<e;r++)i+=(n=t.charCodeAt(r).toString(16)).length<2?"0"+n:n;return i},A.getCanvasFingerprint=function(t){var n=document.createElement("canvas"),i=n.getContext("2d"),i=(i.textBaseline="top",i.font="14px 'Arial'",i.fillStyle="#f60",i.fillRect(125,1,62,20),i.fillStyle="#069",i.fillText(t,2,15),i.fillStyle="rgba(102, 204, 0, 0.7)",i.fillText(t,4,17),n.toDataURL().replace("data:image/png;base64,","")),t=atob(i);return this.bin2hex(t.slice(-16,-12))},A.generateUUID=function(){var i,t,n=localStorage.getItem(this.X);return n||(i=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"==t?n:3&n|8).toString(36)}),t=this.getCanvasFingerprint("hello, zego")+n.slice(8),localStorage.setItem(this.X,t),n)},A.id=function(){var t;return A.W()?((t=localStorage.getItem(this.X))||(t=A.generateUUID(),localStorage.setItem(this.X,t)),t):""},A.X="z_deviceID";var ne=A;function A(){}var ie=function(){this.url="",this.env=o.BROWSER,this.useStrategy=!0,this.token="",this.deviceid=ne.id(),this.ipStackMode=I.IPv4Prefer,this.networkState=L.online};Object.defineProperty(re.prototype,"buffer",{get:function(){return this.queue},set:function(t){this.queue=t},enumerable:!1,configurable:!0}),re.prototype.push=function(t){if(!t)throw new Error("item null!");t&&this.queue.push(t)},re.prototype.pop=function(){return this.queue.shift()},re.prototype.front=function(){return this.queue[0]},re.prototype.clear=function(){this.queue=[]};t=re;function re(){this.queue=[]}ee=function(t,n){return(ee=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)};var ee,se,oe=function(){return(oe=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},ue=(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}ee(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}(fe,se=t),fe.prototype.size=function(){return this.queue.length},fe.prototype.getOneLogPacket=function(){var t=[],n=0,i="";if(this.size()){var r=JSON.parse(this.queue[this.queue.length-1]).userid,e=this.T.userid||r;if(e){for(;0<this.queue.length;){var s=this.queue[0].length;if(n&&4096<n+s)return i=JSON.stringify(t);var o=JSON.parse(this.queue[0]),o=oe(oe({},o),{userid:o.userid||e,roomid:o.roomid||this.T.roomid});n+=s,t.push(o),this.queue.shift()}return""===(i=JSON.stringify(t))?void 0:i}}},fe.prototype.clear=function(){for(var t=[];0<this.queue.length;){var n=this.getOneLogPacket();if(!n)break;t.push(n)}return t},fe);function fe(t,n){void 0===n&&(n=1/0);var i=se.call(this)||this;return i.logCacheMax=n,i.T=t,i}var ce=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},he=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}},ae=(le.prototype.save=function(t){return this.Y.save(this.V,{log:t})},le.prototype.queryList=function(t){return this.Y.queryByCursor(this.V,t)},le.prototype.delete=function(t){return this.Y.deleteItems(this.V,t)},le.prototype.storedBytesSize=function(){var t=this;return new Promise(function(r,e){return ce(t,void 0,void 0,function(){var n,i;return he(this,function(t){return n=this.Y.openCursor(this.V),i=0,n.onsuccess=function(t){var n,t=null==(t=t.target)?void 0:t.result;t?(n=t.value,i+=n.log.length,t.continue()):r(i)},n.onerror=function(t){e(t)},[2]})})})},le.prototype.lines=function(){return this.Y.lines(this.V)},le.prototype.deleteByCount=function(t){return this.Y.deleteByCount(this.V,t)},le.prototype.deleteAll=function(){return this.Y.deleteAll(this.V)},le);function le(t){this.Y=t,this.V="zego_log"}var S=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},ve=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}},de=(j.prototype.openDB=function(e){return S(this,void 0,void 0,function(){var i,n,r=this;return ve(this,function(t){switch(t.label){case 0:return i=window.indexedDB.open(e.database,e.version),n=this,[4,new Promise(function(n){i.onupgradeneeded=function(t){var i=t.target&&t.target.result;e.tableList.forEach(function(t){var n;i.objectStoreNames.contains(t.tableName)||(n=i.createObjectStore(t.tableName,{keyPath:"id",autoIncrement:!0}),t.tableItems.forEach(function(t){t.index&&n.createIndex(t.itemName,t.itemName,{unique:t.unique})}))})},i.onsuccess=function(t){t=t.target&&t.target.result;r.tt=t,n(i)}})];case 1:return n.nt=t.sent(),[2]}})})},j.prototype.it=function(){if(!this.nt&&!this.tt)throw new Error("indexDB not open")},j.prototype.save=function(s,o){var t=this;return new Promise(function(r,e){return S(t,void 0,void 0,function(){var n,i;return ve(this,function(t){return this.it(),n=this.tt.transaction([s],"readwrite").objectStore(s),(i=n.add(o)).onsuccess=function(t){r(i.result)},i.onerror=function(t){e("save item fail")},[2]})})})},j.prototype.update=function(t,n){var i=this;return new Promise(function(t,n){i.it(),t()})},j.prototype.queryById=function(s,o){var t=this;return new Promise(function(r,e){return S(t,void 0,void 0,function(){var n,i;return ve(this,function(t){return this.it(),n=this.tt.transaction([s]).objectStore(s),(i=n.get(o)).onsuccess=function(t){i.result?r(i.result):r(null)},i.onerror=function(t){e()},[2]})})})},j.prototype.queryByCursor=function(s,o){var t=this;return new Promise(function(r,e){return S(t,void 0,void 0,function(){var n,i;return ve(this,function(t){return this.it(),i=this.tt.transaction([s]).objectStore(s),n=[],(i=i.openCursor()).onsuccess=function(t){t=null==(t=t.target)?void 0:t.result;t&&(!o||n.length<o)?(n.push(t.value),t.continue()):r(n)},i.onerror=function(t){e()},[2]})})})},j.prototype.lines=function(s){var t=this;return new Promise(function(r,e){return S(t,void 0,void 0,function(){var n,i;return ve(this,function(t){return this.it(),n=this.tt.transaction([s]).objectStore(s),n=n.openCursor(),i=0,n.onsuccess=function(t){t=null==(t=t.target)?void 0:t.result;t?(i++,t.continue()):r(i)},n.onerror=function(t){e()},[2]})})})},j.prototype.openCursor=function(t){return this.it(),this.tt.transaction([t]).objectStore(t).openCursor()},j.prototype.deleteById=function(e,s){var t=this;return new Promise(function(i,r){return S(t,void 0,void 0,function(){var n;return ve(this,function(t){return this.it(),n=this.tt.transaction([e],"readwrite").objectStore(e),(n=n.delete(s)).onsuccess=function(t){i()},n.onerror=function(t){r()},[2]})})})},j.prototype.deleteByCount=function(e,s){var n=this;return new Promise(function(r,t){return S(n,void 0,void 0,function(){var n,i;return ve(this,function(t){switch(t.label){case 0:this.it(),n=8192,t.label=1;case 1:return 0<s?[4,this.queryByCursor(e,Math.min(s,n))]:[3,4];case 2:return 0===(i=t.sent()).length?[3,4]:(s-=n,[4,this.deleteItems(e,i)]);case 3:return t.sent(),[3,1];case 4:return r(),[2]}})})})},j.prototype.deleteAll=function(e){var t=this;return new Promise(function(i,r){return S(t,void 0,void 0,function(){var n;return ve(this,function(t){return this.it(),n=this.tt.transaction([e],"readwrite").objectStore(e),(n=n.clear()).onsuccess=function(t){i()},n.onerror=function(t){r()},[2]})})})},j.prototype.deleteItems=function(i,r){var t=this;return new Promise(function(n){return S(t,void 0,void 0,function(){var e;return ve(this,function(t){switch(t.label){case 0:return this.it(),e=this.tt.transaction([i],"readwrite").objectStore(i),[4,Promise.all(r.map(function(r){return new Promise(function(n,i){var t=e.delete(r.id);t.onsuccess=function(t){n()},t.onerror=function(t){i()}})}))];case 1:return t.sent(),n(),[2]}})})})},j);function j(){}var we={version:1,database:"zego_logger_db",tableList:[{tableName:"zego_log",tableItems:[{itemName:"log",index:!1,unique:!1}]}]};be=function(t,n){return(be=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)};(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}be(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)})(me,ye=t);var be,ye,_e=me;function me(){return null!==ye&&ye.apply(this,arguments)||this}var pe=function(){return(pe=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},ge=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},Oe=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}},ke=(Ee.prototype.pushTask=function(t,n,i,r,e){t={task:t};n&&(t=pe(pe({},t),{args:n})),i&&(t=pe(pe({},t),{successCallback:i})),r&&(t=pe(pe({},t),{errorCallback:r})),e&&(t=pe(pe({},t),{completeCallback:e})),this.rt.push(t)},Ee.prototype.et=function(r){return ge(this,void 0,void 0,function(){var n,i;return Oe(this,function(t){switch(t.label){case 0:n=null,t.label=1;case 1:return(t.trys.push([1,4,5,6]),r&&r.args?n=r.task.apply(r,r.args):r&&(n=r.task()),n instanceof Promise)?[4,n]:[3,3];case 2:n=t.sent(),t.label=3;case 3:return r.successCallback&&r.successCallback(n),[3,6];case 4:if(i=t.sent(),r.errorCallback)return r.errorCallback(i),[3,6];throw i;case 5:return r.completeCallback&&r.completeCallback(),[7];case 6:return[2]}})})},Ee.prototype.runATask=function(){return ge(this,void 0,void 0,function(){var n;return Oe(this,function(t){switch(t.label){case 0:return this.rt.length<=0?[2]:(n=this.rt.shift(),n?[4,this.et(n)]:[3,2]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ee.prototype.runAllTask=function(){return ge(this,void 0,void 0,function(){var n;return Oe(this,function(t){switch(t.label){case 0:return 0<this.rt.length?(n=this.rt.shift(),n?[4,this.et(n)]:[3,2]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,0];case 3:return[2]}})})},Ee.prototype.size=function(){return this.rt.length},Ee);function Ee(){this.rt=[]}Se.prototype.writeLine=function(t){t&&""!==t&&this.st.push(t)},Se.prototype.saveAs=function(t,n){var i=document.createElement("a");i.href=URL.createObjectURL(t),i.download=n,i.click()},Se.prototype.createZip=function(){var t="";0<this.st.length&&(t=this.st.join("\n"),this.st=[]);t=(t=>{for(var n,i=0,r=t.length,e="";i<r;)n=t.subarray(i,Math.min(i+32768,r)),e+=String.fromCharCode.apply(null,Array.from(n)),i+=32768;return btoa(e)})(pr(t));return new Blob([t],{type:"text/plain;charset=utf-8"})};var Ae=Se;function Se(){this.st=[]}var je=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},Re=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}},xe=(Te.prototype.ot=function(){return!!(this.T.appid&&this.T.userid&&""!==this.T.userid&&this.T.token&&""!==this.T.token&&this.T.deviceid&&""!==this.T.deviceid)},Te.prototype.setUploadUrl=function(t){this.ut=t,this.ft=this.ut[this.ct]},Te.prototype.sendRequest=function(r){return je(this,void 0,void 0,function(){var n,i;return Re(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,6]),[4,Ne.post(this.ft,r,this.proxyCtrl)];case 1:if(0!==(n=t.sent()).code)throw n;return this.M.info("zl.zlu.sr zip log ".concat(this.ft)),[3,6];case 2:if(101!==(null==(n=t.sent())?void 0:n.code)&&this.ct!==this.ut.length-1)return[3,3];throw i=this.ft,this.ct=0,this.ft=this.ut[this.ct],new Error("upload logs ".concat(i," failed, error=").concat(JSON.stringify(n)));case 3:return this.ct++,this.ft=this.ut[this.ct],[4,this.sendRequest(r)];case 4:t.sent(),t.label=5;case 5:return[3,6];case 6:return[2]}})})},Te.prototype.upload=function(s){return je(this,void 0,void 0,function(){var n=this;return Re(this,function(t){if(this.ot())return[2,new Promise(function(r,e){return je(n,void 0,void 0,function(){var n,i=this;return Re(this,function(t){switch(t.label){case 0:return(n=function(){return je(i,void 0,void 0,function(){var n,i,r=this;return Re(this,function(t){switch(t.label){case 0:this.ht=!0,(n=new FormData).append("logs",s),n.append("hello",this.T.appid.toString()),n.append("appid",this.T.appid.toString()),n.append("uin",this.T.userid.toString()),n.append("timestamp",(new Date).getTime().toString()),n.append("token",this.T.token),n.append("deviceid",this.T.deviceid),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,this.sendRequest(n)];case 2:return t.sent(),[3,5];case 3:return i=t.sent(),e(i),[3,5];case 4:return setTimeout(function(){return je(r,void 0,void 0,function(){return Re(this,function(t){switch(t.label){case 0:return this.ht=!1,[4,this.lt.runATask()];case 1:return t.sent(),[2]}})})},100),[7];case 5:return[2]}})})},this.ht)?(this.lt.pushTask(n,[],function(){r()},function(t){e(t)}),[3,3]):[3,1];case 1:return[4,n()];case 2:t.sent(),r(),t.label=3;case 3:return[2]}})})})];throw new Error("cannot upload logs, please login room before you upload logs.")})})},Te);function Te(t,n,i){this.T=t,this.M=n,this.proxyCtrl=i,this.vt="detaillog-global.zego.im",this.ft="https://".concat(this.vt,"/log/userupload"),this.ut=[],this.ct=0,this.lt=new ke,this.ht=!1}var Ze=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},Ue=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}},Ne=(De.post=function(e,s,o){var t=this;return new Promise(function(i,r){return Ze(t,void 0,void 0,function(){var n;return Ue(this,function(t){try{o?o.startHttpRequest({location:e,body:s,method_no:2,headers:[{name:"Content-Type",val:"multipart/form-data"}],serviceType:2},function(t){200===t.status_code?i(t.body):r("request fail. status="+t.status_code)},function(t){r("request fail. result: "+JSON.stringify(t))}):((n=new XMLHttpRequest).open("POST",e,!0),n.responseType="json",n.send(s),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?i(n.response):r("request fail. status="+n.status))})}catch(t){r(t)}return[2]})})})},De);function De(){}var Ie=function(){return(Ie=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Le=(Pe.prototype.build=function(t){var n=Ie(Ie({},JSON.parse(t)),{sdkid:this.dt});if(++this.wt%100==0)return(t=JSON.stringify(n)).substring(1,t.length-1);for(i in n)this.bt.includes(i)||(n[i]===this.yt[i]?delete n[i]:this.yt[i]=n[i]);var i,r=[];for(i in n)this.bt.includes(i)?r.push(n[i]):r.push("".concat(i,":").concat(n[i]));return r.join(",")},Pe.prototype.buildFullMessageLog=function(t){t=JSON.parse(t),t=Ie(Ie(Ie({},this.yt),t),{sdkid:this.dt});return JSON.stringify(t)},Pe);function Pe(t){this.T=t,this.yt={},this.bt=["time","action","content","sdkid"],this.wt=0,this.dt=(t=5,crypto.getRandomValues(new Uint8Array(t)).reduce((t,n)=>t+=(n&=63)<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():62<n?"-":"_",""))}var R=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},x=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}},Fe=(Object.defineProperty(T.prototype,"dbOpened",{get:function(){return this._t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"dbTryOpened",{get:function(){return this.gt},enumerable:!1,configurable:!0}),T.prototype.Ot=function(){return R(this,void 0,void 0,function(){var n;return x(this,function(t){switch(t.label){case 0:return[4,this.kt.lines()];case 1:return 153600<(n=t.sent())?[4,this.kt.deleteByCount(n/2)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},T.prototype.makeStorageSpaceUpload=function(){return R(this,void 0,void 0,function(){var e,n=this;return x(this,function(t){return this.Et?(e=function(){return R(n,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return[4,this.kt.lines()];case 1:return 3072<t.sent()?[4,this.At()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},[2,new Promise(function(i,r){return R(n,void 0,void 0,function(){var n;return x(this,function(t){switch(t.label){case 0:return this.dbOpened?[3,1]:(this.St.pushTask(e,[],function(){i()},function(t){r(t)}),[3,5]);case 1:return t.trys.push([1,3,,4]),[4,e()];case 2:return t.sent(),[3,4];case 3:return n=t.sent(),r(n),[2];case 4:i(),t.label=5;case 5:return[2]}})})})]):[2]})})},T.prototype.openDB=function(){return R(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return this.gt?[2]:(this.gt=!0,[4,this.Y.openDB(we)]);case 1:return t.sent(),this._t=!0,[4,this.Ot()];case 2:return t.sent(),[4,this.St.runAllTask()];case 3:return t.sent(),[4,this.jt.runATask()];case 4:return t.sent(),this.Rt(),[2]}})})},T.prototype.xt=function(){return this.Et&&T.isEnvSupport()&&!this._t&&!this.gt},T.prototype.enable=function(){this.Et||(this.Et=!0,this.xt()&&this.openDB())},T.prototype.saveLog=function(t){this.xt()&&this.openDB(),this.N.push(this.Tt.build(t)),this.Rt()},T.prototype.removeLogList=function(n){return R(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return 0===n.length?[2]:[4,this.kt.delete(n)];case 1:return t.sent(),[2]}})})},T.prototype.empty=function(){return R(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return[4,this.kt.queryList(1)];case 1:return[2,0===t.sent().length]}})})},T.prototype.Rt=function(){var n,i=this;this.Et&&this.dbOpened&&!this.Zt&&(this.Zt=!0,(n=function(){var t=i.N.front();t?t&&i.kt.save(t).then(function(){i.N.pop(),n()}).catch(function(t){i.Zt=!1,console.error(t)}):i.Zt=!1})())},T.isEnvSupport=function(){return!!(window&&"indexedDB"in window)},T.prototype.Ut=function(){return R(this,void 0,void 0,function(){var e,s,n,o;return x(this,function(t){switch(t.label){case 0:return[4,this.kt.lines()];case 1:e=t.sent(),s=3145728,n=function(){var n,i,r;return x(this,function(t){switch(t.label){case 0:return[4,o.kt.queryList(Math.min(s,e))];case 1:return(n=t.sent(),e-=s,n.length<=0)?[2,"break"]:(i=new Ae,n.forEach(function(t){i.writeLine(t.log)}),r=i.createZip(),[4,o.Nt.upload(r)]);case 2:return t.sent(),[4,o.kt.delete(n)];case 3:return t.sent(),[2]}})},o=this,t.label=2;case 2:return 0<e?[5,n()]:[3,4];case 3:return"break"===t.sent()?[3,4]:[3,2];case 4:return[2]}})})},T.prototype.At=function(){var t=this;return new Promise(function(r,e){return R(t,void 0,void 0,function(){var n,i=this;return x(this,function(t){return n=function(){return R(i,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return[4,this.Ut()];case 1:return t.sent(),[2]}})})},this.jt.pushTask(n,[],function(){r()},function(t){e(t)},function(){0<i.jt.size()&&i.jt.runATask()}),this.dbOpened&&1===this.jt.size()&&this.jt.runATask(),[2]})})})},T.prototype.Dt=function(){var t=this;return new Promise(function(r,e){return R(t,void 0,void 0,function(){var n,i=this;return x(this,function(t){return this.It=!1,this.Lt=!0,n=function(){return R(i,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return this.Lt=!0,[4,this.Ut()];case 1:return t.sent(),[2]}})})},this.jt.pushTask(n,[],function(){i.It=!0,i.Lt=!1,r()},function(t){i.Lt=!1,e(t)},function(){0<i.jt.size()&&i.jt.runATask()}),this.dbOpened&&1===this.jt.size()&&this.jt.runATask(),[2]})})})},T.prototype.setUploadUrl=function(t){this.Nt.setUploadUrl(t)},T.prototype.startUpload=function(){return R(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:if(!this.Et)throw new Error("zip logs upload is not enabled.");if(0!==this.Pt&&performance.now()-this.Pt<6e4&&this.It||this.Lt)throw new Error("Logs upload failed. Do not report frequently.");return this.Pt=performance.now(),[4,this.Dt()];case 1:return t.sent(),[2]}})})},T.prototype.destroy=function(){this.N.clear()},T);function T(t,n,i){this.T=t,this.M=n,this.proxyCtrl=i,this.Y=new de,this.kt=new ae(this.Y),this._t=!1,this.gt=!1,this.N=new _e,this.Zt=!1,this.St=new ke,this.jt=new ke,this.Et=!1,this.Pt=0,this.It=!1,this.Lt=!1,this.Nt=new xe(this.T,n,i),this.Tt=new Le(this.T)}var Me=function(){return(Me=Object.assign||function(t){for(var n,i=1,r=arguments.length;i<r;i++)for(var e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},ze=function(t,o,u,f){return new(u=u||Promise)(function(i,n){function r(t){try{s(f.next(t))}catch(t){n(t)}}function e(t){try{s(f.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?i(t.value):((n=t.value)instanceof u?n:new u(function(t){t(n)})).then(r,e)}s((f=f.apply(t,o||[])).next())})},Ce=function(r,e){var s,o,u,f={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var n=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;f=c&&n[c=0]?0:f;)try{if(s=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return f.label++,{value:n[1],done:!1};case 5:f.label++,o=n[1],n=[0];continue;case 7:n=f.ops.pop(),f.trys.pop();continue;default:if(!(u=0<(u=f.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){f=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))f.label=n[1];else if(6===n[0]&&f.label<u[1])f.label=u[1],u=n;else{if(!(u&&f.label<u[2])){u[2]&&f.ops.pop(),f.trys.pop();continue}f.label=u[2],f.ops.push(n)}}n=e.call(r,f)}catch(t){n=[6,t],o=0}finally{s=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}}};Object.defineProperty(Z.prototype,"url",{get:function(){return this.T.url||""},set:function(t){this.T.url=t},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"logType",{get:function(){return this.T.logType||e.DISABLE},set:function(t){this.T.logType=t},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"env",{get:function(){return this.T.env},set:function(t){this.T.env=t},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"appid",{get:function(){return this.T.appid},set:function(t){this.T.appid=t},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"roomid",{get:function(){return this.T.roomid},set:function(t){this.T.roomid=t},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"sessionid",{get:function(){return this.T.sessionid},set:function(t){this.T.sessionid=t},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"userid",{get:function(){return this.T.userid},set:function(t){this.T.userid=t},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"version",{get:function(){return this.T.version},set:function(t){this.T.version=t},enumerable:!1,configurable:!0}),Z.prototype.setLogLevel=function(t){t=s[t];return void 0!==t&&(this.logLevel=t,!0)},Z.prototype.setRemoteLogLevel=function(t){t=s[t];return void 0!==t&&(this.logRemoteLevel=t,!0)},Z.prototype.setSessionInfo=function(t,n,i,r,e,s){this.appid=t,this.roomid=n,this.sessionid=i,this.userid=r,this.version=s},Z.prototype.setTokenInfo=function(t,n){this.T.token=t||"",n&&(this.T.userid=n)},Z.prototype.setZipLogConfig=function(t,n){1===t&&this.Ft?this.Ft.enable():0==t&&n&&this.Ft&&(this.Ft.destroy(),this.Ft=null)},Z.prototype.setZipLogUploadUrl=function(t,n){this.Ft&&(t=this.getLogUrlsByIPStackMode(t,n),this.Ft.setUploadUrl(t))},Z.prototype.makeZipLogSpaceUpload=function(){return ze(this,void 0,void 0,function(){return Ce(this,function(t){switch(t.label){case 0:return this.Ft?[4,this.Ft.makeStorageSpaceUpload()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Z.prototype.uploadStorageLog=function(){return ze(this,void 0,void 0,function(){return Ce(this,function(t){switch(t.label){case 0:return this.Ft?[4,this.Ft.startUpload()]:[3,2];case 1:return t.sent(),[3,3];case 2:throw new Error("cannot use zip log module");case 3:return[2]}})})},Z.prototype.report=function(t){t=this.Mt(s.REPORT,t);this.logLevel!==s.DISABLE&&this.logLevel<=s.REPORT&&!this.isDestroy&&console.debug(t),this.zt(s.REPORT,t,!0)},Z.prototype.debug=function(t,n){var i={},n=("string"==typeof(n=void 0===n?{}:n)?t=Array.from(arguments).join(""):i=n,this.Ct(s.DEBUG,t,i));this.logLevel!==s.DISABLE&&this.logLevel<=s.DEBUG&&!this.isDestroy&&console.debug(n),this.Ht(s.DEBUG,n)},Z.prototype.info=function(t,n){var i={},n=("string"==typeof(n=void 0===n?{}:n)?t=Array.from(arguments).join(""):i=n,this.Ct(s.INFO,t,i));this.logLevel!==s.DISABLE&&this.logLevel<=s.INFO&&!this.isDestroy&&console.info(n),this.Ht(s.INFO,n)},Z.prototype.warn=function(t,n){var i={},n=("string"==typeof(n=void 0===n?{}:n)?t=Array.from(arguments).join(""):i=n,this.Ct(s.WARN,t,i));this.logLevel!==s.DISABLE&&this.logLevel<=s.WARN&&!this.isDestroy&&console.warn(n),this.Ht(s.WARN,n)},Z.prototype.remoteReport=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=this.Ct(s.INFO,t.join(""));this.Ht(s.INFO,i)},Z.prototype.error=function(t,n){var i={},n=("string"==typeof(n=void 0===n?{}:n)?t=Array.from(arguments).join(""):i=n,this.Ct(s.ERROR,t,i));this.logLevel!==s.DISABLE&&this.logLevel<=s.ERROR&&!this.isDestroy&&(console.error(n),this.env%2===o.BROWSER&&window?this.stateCenter.debug&&window.alert(t.substr(t.indexOf(" ")+1,4500)):(this.env,o.WEIXINMINI)),this.Ht(s.ERROR,n)},Z.prototype.Ht=function(t,n){this.logRemoteLevel!==s.DISABLE&&this.logRemoteLevel<=t&&(this.zt(t,n),this.Ft)&&this.Ft.saveLog(n)},Z.prototype.setSettingConfig=function(t){this.T.ipStackMode=t.ipStackMode},Z.prototype.getLogUrlsByIPStackMode=function(t,n){var i=[];switch(this.T.ipStackMode){case I.IPv4Only:i.push.apply(i,t);break;case I.IPv4Prefer:i.push.apply(i,t),i.push.apply(i,n);break;case I.IPv6Prefer:i.push.apply(i,n),i.push.apply(i,t);break;default:i.push.apply(i,t)}return i},Z.prototype.onConnected=function(t){},Z.prototype.setLogServer=function(t,n){var i;if(this.isDestroy)return!1;if(this.logConnected)return!1;n=0===this.T.env?(this.T.connectURLs=this.getLogUrlsByIPStackMode(t,n),this.T.connectURLs[this.urlIndex]):(this.T.connectURLs=t,this.url!==this.T.connectURLs[0]&&(this.logConnected=!1),this.T.connectURLs[0]);try{return n.startsWith("wss:")?(this.logType=e.WEBSOCKET,null!=(i=this.Bt)&&i.openWebSocketLogServer(n,!0)):n.startsWith("https:")?(this.logType=e.HTTPS,this.qt(n)):this.logType=e.DISABLE,!0}catch(t){return this.error(JSON.stringify(t)),!1}},Z.prototype.Jt=function(){this.logType==e.WEBSOCKET?this.Gt():this.logType==e.HTTPS&&(this.Kt(),this.Wt()),this.logType=e.DISABLE},Z.prototype.Gt=function(){var t;null!=(t=this.Bt)&&t.stopWebSocketServer()},Z.prototype.qt=function(t){var n=this;(this.url=t)&&(this.Wt(),this.logUploadTimer||(this.logUploadTimer=setInterval(function(){n.Kt()},this.logUploadInterval)))},Z.prototype.Wt=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},Z.prototype.zt=function(n,i,r){return void 0===r&&(r=!1),ze(this,void 0,void 0,function(){return Ce(this,function(t){if(!this.isDestroy)if(this.logType==e.WEBSOCKET)this.Xt(n,i);else if(this.logType==e.HTTPS)this.$t(n,i,r);else if(this.logLevel!==s.DISABLE&&this.logLevel<=n){if(4e3<i.length)return[2];for(this.Yt.push(i);this.Yt.size()>this.Vt;)this.Yt.pop()}return[2]})})},Z.prototype.clearCache=function(){var t;0!==this.Yt.size()&&null!=(t=this.Bt)&&t.clearLogCacheAndUpload()},Z.prototype.Xt=function(e,n){var s;return ze(this,void 0,void 0,function(){var i,r=this;return Ce(this,function(t){return"string"==typeof n&&4e3<n.length?((t,n)=>{void 0===n&&(n=2e3);for(var i=[],r=0;r<t.length;)i.push(t.substring(r,r+n)),r+=n;return i})((i=JSON.parse(n)).content,3e3).forEach(function(t,n){3<n||(i.content="s".concat(n+1,": ").concat(t),r.Xt(e,JSON.stringify(i)))}):this.T.useStrategy&&this.env==o.BROWSER&&null!=(s=this.Bt)&&s.addRemoteWsLog(n),[2]})})},Z.prototype.$t=function(t,n,i){this.Yt.push(n),(this.Yt.size()>=this.Vt||!0===i)&&this.Kt()},Z.prototype.Ct=function(t,n,i){void 0===i&&(i={});var r=q(),n=[n.substr(0,n.indexOf(" "))||n,n.substr(n.indexOf(" ")+1,8e3)||n],e=n[0],n=n[1],i=Me(Me({},i),{time:r,level:t,action:e,content:n,appid:this.appid,roomid:this.roomid||void 0,userid:this.userid,sessionid:this.sessionid||void 0});return JSON.stringify(i)},Z.prototype.Mt=function(t,n){var i=q(),r="",r=this.env%2===o.BROWSER?"rtc":"ali";return n=Me(Me({},n),{time:i,level:t,console:r,appid:this.appid,room_id:this.roomid,roomid:this.roomid,userid:this.userid,id_name:this.userid,sessionid:this.sessionid,sdk_version:this.version,test_environment:this.stateCenter.testEnvironment,version:this.version,event_id:this.appid+"_"+this.userid+"_"+n.event_time+"_"+n.seq}),JSON.stringify(n)},Z.prototype.Kt=function(){0!=this.Yt.size()&&(this.env%2===o.BROWSER?this.Qt():this.SendHttpsLogWeChatMini())},Z.prototype.Qt=function(){var n=this,t=this.Yt.buffer.join("\n"),i=this.Yt.buffer,r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){if(200==r.status){if(n.logConnected=!0,0==r.responseText.length)return;try{var t=JSON.parse(r.responseText).interval;"number"==typeof t&&n.logUploadInterval!==t&&(n.timeInterval=t,n.qt(n.url))}catch(t){n.Yt.buffer=i.concat(n.Yt.buffer),console.log("send result failed "+t)}}else n.Yt.buffer=i.concat(n.Yt.buffer);i=null}},r.open("POST",this.url,!0),0==this.env?r.send(t):1==this.env&&(r.setRequestHeader("content-type","application/json"),r.send(JSON.stringify({user_id:this.userid,log:t}))),this.Yt.buffer=[]},Z.prototype.SendHttpsLogWeChatMini=function(){},Z.prototype.retryConnectSocket=function(){var t,n;100<performance.now()-this.wsConnectFailTime&&(this.tryIndex++,t=this.T.networkState===L.offline,n=void this.M.info("zl.rcs.0 ".concat(JSON.stringify(this.T.connectURLs)," ").concat(this.tryIndex," ").concat(this.urlIndex)),n=this.tryIndex<this.urlTryMaxCount?this.url:(this.tryIndex=0,this.urlIndex++,this.T.connectURLs[this.urlIndex%this.T.connectURLs.length]),t?null!=(t=this.Bt)&&t.openWebSocketLogServer(n,!1,!0,this.tn):null!=(t=this.Bt)&&t.openWebSocketLogServer(n,!1,!0,this.nn)),this.wsConnectFailTime=performance.now()},Z.prototype.listener=function(){var t=this;this.env==o.BROWSER&&(window.addEventListener("online",function(){t.T.networkState=L.online,t.reconnectLogServer()}),window.addEventListener("offline",function(){t.T.networkState=L.offline})),this.Bt&&(this.Bt.onSocketConnect=function(){t.logConnected=!0,t.T.networkState=L.online,t.onConnected({url:t.url})},this.Bt.onSocketClose=function(){t.retryConnectSocket()},this.Bt.onSocketError=function(){t.retryConnectSocket()},this.Bt.onHeartBeatTimeout=function(){t.reconnectLogServer()})},Z.prototype.reconnectLogServer=function(){var t,n;this.logType===e.WEBSOCKET&&(this.M.info("zl.rcs.1 call"),this.tryIndex=0,this.urlIndex=0,n=this.T.connectURLs[this.urlIndex],this.url="",null!=(t=this.Bt)&&t.resetSocketTimer(),null!=(t=this.Bt))&&t.openWebSocketLogServer(n,!1,!0,this.nn)},Z.prototype.destroy=function(){var t;this.Jt(),this.logUploadTimer&&clearTimeout(this.logUploadTimer),D.instance=void 0,null!=(t=this.Bt)&&t.destroy(),this.Ft&&this.Ft.destroy(),this.url="",this.isDestroy=!0,this.tryIndex=0,this.urlIndex=0},Z.logVersion="1.4.14";var He=Z;function Z(t,n){this.proxyCtrl=n,this.logLevel=s.INFO,this.logRemoteLevel=0,this.logUploadTimer=null,this.logUploadInterval=1e4,this.existUserID=!1,this.isDestroy=!1,this.Vt=8192,this.nn=2e3,this.tn=5e3,this.M={debug:this.debug.bind(this),info:this.info.bind(this),warn:this.warn.bind(this),error:this.error.bind(this)},this.logConnected=!1,this.tryIndex=0,this.urlIndex=0,this.urlTryMaxCount=3,this.wsConnectFailTime=0,this.urlGroups={v4:[],v6:[]},this.inflate=gr,this.deflate=pr,this.stateCenter=D.getInstance(),this.T=new ie,this.T.env=t,this.Yt=new ue(this.T,this.Vt),this.Bt=new xr(this.Yt,this.T,this.M,this.proxyCtrl),this.listener(),this.env==o.BROWSER&&Fe.isEnvSupport()&&(this.Ft=new Fe(this.T,this.M,this.proxyCtrl))}}],o={},e.m=s,e.c=o,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"rn",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.rn)return n;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var r in n)e.d(i,r,function(t){return n[t]}.bind(null,r));return i},e.n=function(t){var n=t&&t.rn?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=3);function e(t){var n;return(o[t]||(n=o[t]={i:t,l:!1,exports:{}},s[t].call(n.exports,n,n.exports,e),n.l=!0,n)).exports}var s,o});